

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>matplotlib.figure &mdash; BMCTool</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=16f952a1" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            BMCTool
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide.html">Guide for Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributor_guide.html">Guide for Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BMCTool</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">matplotlib.figure</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for matplotlib.figure</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">`matplotlib.figure` implements the following classes:</span>

<span class="sd">`Figure`</span>
<span class="sd">    Top level `~matplotlib.artist.Artist`, which holds all plot elements.</span>
<span class="sd">    Many methods are implemented in `FigureBase`.</span>

<span class="sd">`SubFigure`</span>
<span class="sd">    A logical figure inside a figure, usually added to a figure (or parent `SubFigure`)</span>
<span class="sd">    with `Figure.add_subfigure` or `Figure.subfigures` methods.</span>

<span class="sd">Figures are typically created using pyplot methods `~.pyplot.figure`,</span>
<span class="sd">`~.pyplot.subplots`, and `~.pyplot.subplot_mosaic`.</span>

<span class="sd">.. plot::</span>
<span class="sd">    :include-source:</span>

<span class="sd">    fig, ax = plt.subplots(figsize=(2, 2), facecolor=&#39;lightskyblue&#39;,</span>
<span class="sd">                           layout=&#39;constrained&#39;)</span>
<span class="sd">    fig.suptitle(&#39;Figure&#39;)</span>
<span class="sd">    ax.set_title(&#39;Axes&#39;, loc=&#39;left&#39;, fontstyle=&#39;oblique&#39;, fontsize=&#39;medium&#39;)</span>

<span class="sd">Some situations call for directly instantiating a `~.figure.Figure` class,</span>
<span class="sd">usually inside an application of some sort (see :ref:`user_interfaces` for a</span>
<span class="sd">list of examples) .  More information about Figures can be found at</span>
<span class="sd">:ref:`figure-intro`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExitStack</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numbers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Integral</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_blocking_input</span><span class="p">,</span> <span class="n">backend_bases</span><span class="p">,</span> <span class="n">_docstring</span><span class="p">,</span> <span class="n">projections</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.artist</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Artist</span><span class="p">,</span> <span class="n">allow_rasterization</span><span class="p">,</span> <span class="n">_finalize_rasterization</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.backend_bases</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">DrawEvent</span><span class="p">,</span> <span class="n">FigureCanvasBase</span><span class="p">,</span> <span class="n">NonGuiException</span><span class="p">,</span> <span class="n">MouseButton</span><span class="p">,</span> <span class="n">_get_renderer</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib._api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">_api</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cbook</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cbook</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colorbar</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cbar</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.image</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mimage</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.axes</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.gridspec</span><span class="w"> </span><span class="kn">import</span> <span class="n">GridSpec</span><span class="p">,</span> <span class="n">SubplotParams</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.layout_engine</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">ConstrainedLayoutEngine</span><span class="p">,</span> <span class="n">TightLayoutEngine</span><span class="p">,</span> <span class="n">LayoutEngine</span><span class="p">,</span>
    <span class="n">PlaceHolderLayoutEngine</span>
<span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.legend</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mlegend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rectangle</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">Text</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.transforms</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">Affine2D</span><span class="p">,</span> <span class="n">Bbox</span><span class="p">,</span> <span class="n">BboxTransformTo</span><span class="p">,</span>
                                   <span class="n">TransformedBbox</span><span class="p">)</span>

<span class="n">_log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_stale_figure_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">fig</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="n">val</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_AxesStack</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper class to track Axes in a figure.</span>

<span class="sd">    Axes are tracked both in the order in which they have been added</span>
<span class="sd">    (``self._axes`` insertion/iteration order) and in the separate &quot;gca&quot; stack</span>
<span class="sd">    (which is the index to which they map in the ``self._axes`` dict).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Mapping of Axes to &quot;gca&quot; order.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">as_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List the Axes that have been added to the figure.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="p">]</span>  <span class="c1"># This relies on dict preserving order.</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the Axes from the stack.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bubble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Move an Axes, which must already exist in the stack, to the top.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Axes has not been added yet&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add an Axes to the stack, ignoring it if already present.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">current</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the active Axes, or None if the stack is empty.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
            <span class="s2">&quot;_counter&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">next_counter</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_counter&#39;</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">next_counter</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">FigureBase</span><span class="p">(</span><span class="n">Artist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for `.Figure` and `.SubFigure` containing the methods that add</span>
<span class="sd">    artists to the figure or subfigure, create Axes, etc.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># remove the non-figure artist _axes property</span>
        <span class="c1"># as it makes no sense for a figure to be _in_ an Axes</span>
        <span class="c1"># this is used by the property methods in the artist base class</span>
        <span class="c1"># which are over-ridden in this class</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_supxlabel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_supylabel</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># groupers to keep track of x, y labels and title we want to align.</span>
        <span class="c1"># see self.align_xlabels, self.align_ylabels,</span>
        <span class="c1"># self.align_titles, and axis._get_tick_boxes_siblings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_align_label_groups</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">cbook</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(),</span>
            <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">cbook</span><span class="o">.</span><span class="n">Grouper</span><span class="p">(),</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">cbook</span><span class="o">.</span><span class="n">Grouper</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_localaxes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># track all Axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_draw_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Also runs apply_aspect&quot;&quot;&quot;</span>
        <span class="n">artists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>

        <span class="n">artists</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
        <span class="n">artists</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">(</span><span class="n">artist</span> <span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="n">artists</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_animated</span><span class="p">()),</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">artist</span><span class="p">:</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_zorder</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localaxes</span><span class="p">:</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_axes_locator</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">apply_aspect</span><span class="p">(</span><span class="n">locator</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span> <span class="k">if</span> <span class="n">locator</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_children</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="s1">&#39;apply_aspect&#39;</span><span class="p">):</span>
                    <span class="n">locator</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">get_axes_locator</span><span class="p">()</span>
                    <span class="n">child</span><span class="o">.</span><span class="n">apply_aspect</span><span class="p">(</span>
                        <span class="n">locator</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span> <span class="k">if</span> <span class="n">locator</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">artists</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">autofmt_xdate</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Date ticklabels often overlap, so it is useful to rotate them</span>
<span class="sd">        and right align them.  Also, a common use case is a number of</span>
<span class="sd">        subplots with shared x-axis where the x-axis is date data.  The</span>
<span class="sd">        ticklabels are often long, and it helps to rotate them on the</span>
<span class="sd">        bottom subplot and turn them off on other subplots, as well as</span>
<span class="sd">        turn off xlabels.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bottom : float, default: 0.2</span>
<span class="sd">            The bottom of the subplots for `subplots_adjust`.</span>
<span class="sd">        rotation : float, default: 30 degrees</span>
<span class="sd">            The rotation angle of the xtick labels in degrees.</span>
<span class="sd">        ha : {&#39;left&#39;, &#39;center&#39;, &#39;right&#39;}, default: &#39;right&#39;</span>
<span class="sd">            The horizontal alignment of the xticklabels.</span>
<span class="sd">        which : {&#39;major&#39;, &#39;minor&#39;, &#39;both&#39;}, default: &#39;major&#39;</span>
<span class="sd">            Selects which ticklabels to rotate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_in_list</span><span class="p">([</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="s1">&#39;minor&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">],</span> <span class="n">which</span><span class="o">=</span><span class="n">which</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">_label</span> <span class="o">!=</span> <span class="s1">&#39;&lt;colorbar&gt;&#39;</span><span class="p">]</span>
        <span class="n">allsubplots</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="n">which</span><span class="p">):</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_ha</span><span class="p">(</span><span class="n">ha</span><span class="p">)</span>
                <span class="n">label</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">allsubplots</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">is_last_row</span><span class="p">():</span>
                        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="n">which</span><span class="p">):</span>
                            <span class="n">label</span><span class="o">.</span><span class="n">set_ha</span><span class="p">(</span><span class="n">ha</span><span class="p">)</span>
                            <span class="n">label</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="n">which</span><span class="p">):</span>
                            <span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">allsubplots</span> <span class="ow">and</span> <span class="p">(</span><span class="n">engine</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">engine</span><span class="o">.</span><span class="n">adjust_compatible</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of artists contained in the figure.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">artists</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_localaxes</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lines</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">patches</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="p">,</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `.Figure` or `.SubFigure` instance the (Sub)Figure belongs to.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        root : bool, default=True</span>
<span class="sd">            If False, return the (Sub)Figure this artist is on.  If True,</span>
<span class="sd">            return the root Figure for a nested tree of SubFigures.</span>

<span class="sd">            .. deprecated:: 3.10</span>

<span class="sd">                From version 3.12 *root* will default to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="c1"># Top level Figure</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span><span class="p">:</span>
            <span class="c1"># Return early to prevent the deprecation warning when *root* does not</span>
            <span class="c1"># matter</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

        <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># When deprecation expires, consider removing the docstring and just</span>
            <span class="c1"># inheriting the one from Artist.</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;From Matplotlib 3.12 SubFigure.get_figure will by default &#39;</span>
                       <span class="s1">&#39;return the direct parent figure, which may be a SubFigure. &#39;</span>
                       <span class="s1">&#39;To suppress this warning, pass the root parameter.  Pass &#39;</span>
                       <span class="s1">&#39;`True` to maintain the old behavior and `False` to opt-in to &#39;</span>
                       <span class="s1">&#39;the future behavior.&#39;</span><span class="p">)</span>
            <span class="n">_api</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span><span class="s1">&#39;3.10&#39;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
            <span class="n">root</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">root</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. deprecated:: 3.10</span>
<span class="sd">            Currently this method will raise an exception if *fig* is anything other</span>
<span class="sd">            than the root `.Figure` this (Sub)Figure is on.  In future it will always</span>
<span class="sd">            raise an exception.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">no_switch</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;The parent and root figures of a (Sub)Figure are set at &quot;</span>
                     <span class="s2">&quot;instantiation and cannot be changed.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span><span class="p">:</span>
            <span class="n">_api</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span>
                <span class="s2">&quot;3.10&quot;</span><span class="p">,</span>
                <span class="n">message</span><span class="o">=</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">no_switch</span><span class="si">}</span><span class="s2"> From Matplotlib 3.12 this operation will raise &quot;</span>
                         <span class="s2">&quot;an exception.&quot;</span><span class="p">))</span>
            <span class="k">return</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">no_switch</span><span class="p">)</span>

    <span class="n">figure</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">get_figure</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">set_figure</span><span class="p">,</span>
                      <span class="n">doc</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;The root `Figure`.  To get the parent of a `SubFigure`, &quot;</span>
                           <span class="s2">&quot;use the `get_figure` method.&quot;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test whether the mouse event occurred on the figure.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            bool, {}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_different_canvas</span><span class="p">(</span><span class="n">mouseevent</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_suplabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a centered %(name)s to the figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        t : str</span>
<span class="sd">            The %(name)s text.</span>
<span class="sd">        x : float, default: %(x0)s</span>
<span class="sd">            The x location of the text in figure coordinates.</span>
<span class="sd">        y : float, default: %(y0)s</span>
<span class="sd">            The y location of the text in figure coordinates.</span>
<span class="sd">        horizontalalignment, ha : {&#39;center&#39;, &#39;left&#39;, &#39;right&#39;}, default: %(ha)s</span>
<span class="sd">            The horizontal alignment of the text relative to (*x*, *y*).</span>
<span class="sd">        verticalalignment, va : {&#39;top&#39;, &#39;center&#39;, &#39;bottom&#39;, &#39;baseline&#39;}, \</span>
<span class="sd">default: %(va)s</span>
<span class="sd">            The vertical alignment of the text relative to (*x*, *y*).</span>
<span class="sd">        fontsize, size : default: :rc:`figure.%(rc)ssize`</span>
<span class="sd">            The font size of the text. See `.Text.set_size` for possible</span>
<span class="sd">            values.</span>
<span class="sd">        fontweight, weight : default: :rc:`figure.%(rc)sweight`</span>
<span class="sd">            The font weight of the text. See `.Text.set_weight` for possible</span>
<span class="sd">            values.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        text</span>
<span class="sd">            The `.Text` instance of the %(name)s.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        fontproperties : None or dict, optional</span>
<span class="sd">            A dict of font properties. If *fontproperties* is given the</span>
<span class="sd">            default values for font size and weight are taken from the</span>
<span class="sd">            `.FontProperties` defaults. :rc:`figure.%(rc)ssize` and</span>
<span class="sd">            :rc:`figure.%(rc)sweight` are ignored in this case.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional kwargs are `matplotlib.text.Text` properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;_supxlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;_suptitle&#39;</span><span class="p">]:</span>
            <span class="n">autopos</span> <span class="o">=</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_supylabel&#39;</span><span class="p">:</span>
            <span class="n">autopos</span> <span class="o">=</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">normalize_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">Text</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;horizontalalignment&#39;</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">])</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;verticalalignment&#39;</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;va&#39;</span><span class="p">])</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;rotation&#39;</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;rotation&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;fontproperties&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fontsize&#39;</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]])</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fontweight&#39;</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]])</span>

        <span class="n">suplab</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">suplab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">suplab</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">suplab</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">suplab</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">suplab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">suplab</span><span class="p">)</span>
        <span class="n">suplab</span><span class="o">.</span><span class="n">_autopos</span> <span class="o">=</span> <span class="n">autopos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">suplab</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">Substitution</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;super title&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                             <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_suplabels</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">suptitle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># docstring from _suplabels...</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_suptitle&#39;</span><span class="p">,</span> <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;y0&#39;</span><span class="p">:</span> <span class="mf">0.98</span><span class="p">,</span>
                <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;rotation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;figure.titlesize&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;figure.titleweight&#39;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suplabels</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_suptitle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the suptitle as string or an empty string if not set.&quot;&quot;&quot;</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">text_obj</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">Substitution</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;super xlabel&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                             <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_suplabels</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">supxlabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># docstring from _suplabels...</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_supxlabel&#39;</span><span class="p">,</span> <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;y0&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
                <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="s1">&#39;rotation&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;figure.labelsize&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;figure.labelweight&#39;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suplabels</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_supxlabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the supxlabel as string or an empty string if not set.&quot;&quot;&quot;</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supxlabel</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">text_obj</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">Substitution</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;super ylabel&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                             <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_suplabels</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">supylabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># docstring from _suplabels...</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_supylabel&#39;</span><span class="p">,</span> <span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;y0&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                <span class="s1">&#39;ha&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;va&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;rotation&#39;</span><span class="p">:</span> <span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                <span class="s1">&#39;rotation_mode&#39;</span><span class="p">:</span> <span class="s1">&#39;anchor&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="s1">&#39;figure.labelsize&#39;</span><span class="p">,</span>
                <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;figure.labelweight&#39;</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suplabels</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_supylabel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the supylabel as string or an empty string if not set.&quot;&quot;&quot;</span>
        <span class="n">text_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_supylabel</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">text_obj</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">text_obj</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the edge color of the Figure rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_edgecolor</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the face color of the Figure rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_frameon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the figure&#39;s background patch visibility, i.e.</span>
<span class="sd">        whether the figure background will be drawn. Equivalent to</span>
<span class="sd">        ``Figure.patch.get_visible()``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_linewidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the line width of the Figure rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        linewidth : number</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_linewidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the line width of the Figure rectangle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_linewidth</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the edge color of the Figure rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : :mpltype:`color`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the face color of the Figure rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : :mpltype:`color`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_frameon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the figure&#39;s background patch visibility, i.e.</span>
<span class="sd">        whether the figure background will be drawn. Equivalent to</span>
<span class="sd">        ``Figure.patch.set_visible()``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">frameon</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_frameon</span><span class="p">,</span> <span class="n">set_frameon</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an `.Artist` to the figure.</span>

<span class="sd">        Usually artists are added to `~.axes.Axes` objects using</span>
<span class="sd">        `.Axes.add_artist`; this method can be used in the rare cases where</span>
<span class="sd">        one needs to add artists directly to the figure instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        artist : `~matplotlib.artist.Artist`</span>
<span class="sd">            The artist to add to the figure. If the added artist has no</span>
<span class="sd">            transform previously set, its transform will be set to</span>
<span class="sd">            ``figure.transSubfigure``.</span>
<span class="sd">        clip : bool, default: False</span>
<span class="sd">            Whether the added artist should be clipped by the figure patch.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~matplotlib.artist.Artist`</span>
<span class="sd">            The added artist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">artist</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">artist</span><span class="p">)</span>
        <span class="n">artist</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">artists</span><span class="o">.</span><span class="n">remove</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">artist</span><span class="o">.</span><span class="n">is_transform_set</span><span class="p">():</span>
            <span class="n">artist</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transSubfigure</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">clip</span> <span class="ow">and</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_clip_path</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">artist</span><span class="o">.</span><span class="n">set_clip_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">artist</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an `~.axes.Axes` to the figure.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">            add_axes(rect, projection=None, polar=False, **kwargs)</span>
<span class="sd">            add_axes(ax)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rect : tuple (left, bottom, width, height)</span>
<span class="sd">            The dimensions (left, bottom, width, height) of the new</span>
<span class="sd">            `~.axes.Axes`. All quantities are in fractions of figure width and</span>
<span class="sd">            height.</span>

<span class="sd">        projection : {None, &#39;aitoff&#39;, &#39;hammer&#39;, &#39;lambert&#39;, &#39;mollweide&#39;, \</span>
<span class="sd">&#39;polar&#39;, &#39;rectilinear&#39;, str}, optional</span>
<span class="sd">            The projection type of the `~.axes.Axes`. *str* is the name of</span>
<span class="sd">            a custom projection, see `~matplotlib.projections`. The default</span>
<span class="sd">            None results in a &#39;rectilinear&#39; projection.</span>

<span class="sd">        polar : bool, default: False</span>
<span class="sd">            If True, equivalent to projection=&#39;polar&#39;.</span>

<span class="sd">        axes_class : subclass type of `~.axes.Axes`, optional</span>
<span class="sd">            The `.axes.Axes` subclass that is instantiated.  This parameter</span>
<span class="sd">            is incompatible with *projection* and *polar*.  See</span>
<span class="sd">            :ref:`axisartist_users-guide-index` for examples.</span>

<span class="sd">        sharex, sharey : `~matplotlib.axes.Axes`, optional</span>
<span class="sd">            Share the x or y `~matplotlib.axis` with sharex and/or sharey.</span>
<span class="sd">            The axis will have the same limits, ticks, and scale as the axis</span>
<span class="sd">            of the shared Axes.</span>

<span class="sd">        label : str</span>
<span class="sd">            A label for the returned Axes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~.axes.Axes`, or a subclass of `~.axes.Axes`</span>
<span class="sd">            The returned Axes class depends on the projection used. It is</span>
<span class="sd">            `~.axes.Axes` if rectilinear projection is used and</span>
<span class="sd">            `.projections.polar.PolarAxes` if polar projection is used.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            This method also takes the keyword arguments for</span>
<span class="sd">            the returned Axes class. The keyword arguments for the</span>
<span class="sd">            rectilinear Axes class `~.axes.Axes` can be found in</span>
<span class="sd">            the following table but there might also be other keyword</span>
<span class="sd">            arguments if another projection is used, see the actual Axes</span>
<span class="sd">            class.</span>

<span class="sd">            %(Axes:kwdoc)s</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        In rare circumstances, `.add_axes` may be called with a single</span>
<span class="sd">        argument, an Axes instance already created in the present figure but</span>
<span class="sd">        not in the figure&#39;s list of Axes.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Figure.add_subplot</span>
<span class="sd">        .pyplot.subplot</span>
<span class="sd">        .pyplot.axes</span>
<span class="sd">        .Figure.subplots</span>
<span class="sd">        .pyplot.subplots</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Some simple examples::</span>

<span class="sd">            rect = l, b, w, h</span>
<span class="sd">            fig = plt.figure()</span>
<span class="sd">            fig.add_axes(rect)</span>
<span class="sd">            fig.add_axes(rect, frameon=False, facecolor=&#39;g&#39;)</span>
<span class="sd">            fig.add_axes(rect, polar=True)</span>
<span class="sd">            ax = fig.add_axes(rect, projection=&#39;polar&#39;)</span>
<span class="sd">            fig.delaxes(ax)</span>
<span class="sd">            fig.add_axes(ax)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;rect&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add_axes() missing 1 required positional argument: &#39;rect&#39;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;rect&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add_axes() got multiple values for argument &#39;rect&#39;&quot;</span><span class="p">)</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rect&#39;</span><span class="p">),</span> <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">_api</span><span class="o">.</span><span class="n">nargs_error</span><span class="p">(</span><span class="s2">&quot;add_axes&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Axes</span><span class="p">):</span>
            <span class="n">a</span><span class="p">,</span> <span class="o">=</span> <span class="n">args</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">_projection_init</span>
            <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The Axes must have been created in the present figure&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rect</span><span class="p">,</span> <span class="o">=</span> <span class="n">args</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;all entries in rect must be finite not </span><span class="si">{</span><span class="n">rect</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">projection_class</span><span class="p">,</span> <span class="n">pkw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_projection_requirements</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># create the new Axes using the Axes class given</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">projection_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="o">**</span><span class="n">pkw</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">projection_class</span><span class="p">,</span> <span class="n">pkw</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_axes_internal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_subplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an `~.axes.Axes` to the figure as part of a subplot arrangement.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">           add_subplot(nrows, ncols, index, **kwargs)</span>
<span class="sd">           add_subplot(pos, **kwargs)</span>
<span class="sd">           add_subplot(ax)</span>
<span class="sd">           add_subplot()</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *args : int, (int, int, *index*), or `.SubplotSpec`, default: (1, 1, 1)</span>
<span class="sd">            The position of the subplot described by one of</span>

<span class="sd">            - Three integers (*nrows*, *ncols*, *index*). The subplot will</span>
<span class="sd">              take the *index* position on a grid with *nrows* rows and</span>
<span class="sd">              *ncols* columns. *index* starts at 1 in the upper left corner</span>
<span class="sd">              and increases to the right.  *index* can also be a two-tuple</span>
<span class="sd">              specifying the (*first*, *last*) indices (1-based, and including</span>
<span class="sd">              *last*) of the subplot, e.g., ``fig.add_subplot(3, 1, (1, 2))``</span>
<span class="sd">              makes a subplot that spans the upper 2/3 of the figure.</span>
<span class="sd">            - A 3-digit integer. The digits are interpreted as if given</span>
<span class="sd">              separately as three single-digit integers, i.e.</span>
<span class="sd">              ``fig.add_subplot(235)`` is the same as</span>
<span class="sd">              ``fig.add_subplot(2, 3, 5)``. Note that this can only be used</span>
<span class="sd">              if there are no more than 9 subplots.</span>
<span class="sd">            - A `.SubplotSpec`.</span>

<span class="sd">            In rare circumstances, `.add_subplot` may be called with a single</span>
<span class="sd">            argument, a subplot Axes instance already created in the</span>
<span class="sd">            present figure but not in the figure&#39;s list of Axes.</span>

<span class="sd">        projection : {None, &#39;aitoff&#39;, &#39;hammer&#39;, &#39;lambert&#39;, &#39;mollweide&#39;, \</span>
<span class="sd">&#39;polar&#39;, &#39;rectilinear&#39;, str}, optional</span>
<span class="sd">            The projection type of the subplot (`~.axes.Axes`). *str* is the</span>
<span class="sd">            name of a custom projection, see `~matplotlib.projections`. The</span>
<span class="sd">            default None results in a &#39;rectilinear&#39; projection.</span>

<span class="sd">        polar : bool, default: False</span>
<span class="sd">            If True, equivalent to projection=&#39;polar&#39;.</span>

<span class="sd">        axes_class : subclass type of `~.axes.Axes`, optional</span>
<span class="sd">            The `.axes.Axes` subclass that is instantiated.  This parameter</span>
<span class="sd">            is incompatible with *projection* and *polar*.  See</span>
<span class="sd">            :ref:`axisartist_users-guide-index` for examples.</span>

<span class="sd">        sharex, sharey : `~matplotlib.axes.Axes`, optional</span>
<span class="sd">            Share the x or y `~matplotlib.axis` with sharex and/or sharey.</span>
<span class="sd">            The axis will have the same limits, ticks, and scale as the axis</span>
<span class="sd">            of the shared Axes.</span>

<span class="sd">        label : str</span>
<span class="sd">            A label for the returned Axes.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~.axes.Axes`</span>

<span class="sd">            The Axes of the subplot. The returned Axes can actually be an</span>
<span class="sd">            instance of a subclass, such as `.projections.polar.PolarAxes` for</span>
<span class="sd">            polar projections.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            This method also takes the keyword arguments for the returned Axes</span>
<span class="sd">            base class; except for the *figure* argument. The keyword arguments</span>
<span class="sd">            for the rectilinear base class `~.axes.Axes` can be found in</span>
<span class="sd">            the following table but there might also be other keyword</span>
<span class="sd">            arguments if another projection is used.</span>

<span class="sd">            %(Axes:kwdoc)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Figure.add_axes</span>
<span class="sd">        .pyplot.subplot</span>
<span class="sd">        .pyplot.axes</span>
<span class="sd">        .Figure.subplots</span>
<span class="sd">        .pyplot.subplots</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            fig = plt.figure()</span>

<span class="sd">            fig.add_subplot(231)</span>
<span class="sd">            ax1 = fig.add_subplot(2, 3, 1)  # equivalent but more general</span>

<span class="sd">            fig.add_subplot(232, frameon=False)  # subplot with no frame</span>
<span class="sd">            fig.add_subplot(233, projection=&#39;polar&#39;)  # polar subplot</span>
<span class="sd">            fig.add_subplot(234, sharex=ax1)  # subplot sharing x-axis with ax1</span>
<span class="sd">            fig.add_subplot(235, facecolor=&quot;red&quot;)  # red subplot</span>

<span class="sd">            ax1.remove()  # delete ax1 from the figure</span>
<span class="sd">            fig.add_subplot(ax1)  # add ax1 back to the figure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;figure&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="c1"># Axes itself allows for a &#39;figure&#39; kwarg, but since we want to</span>
            <span class="c1"># bind the created Axes to self, it is not allowed here.</span>
            <span class="k">raise</span> <span class="n">_api</span><span class="o">.</span><span class="n">kwarg_error</span><span class="p">(</span><span class="s2">&quot;add_subplot&quot;</span><span class="p">,</span> <span class="s2">&quot;figure&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_base</span><span class="o">.</span><span class="n">_AxesBase</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">_projection_init</span>
            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The Axes must have been created in &quot;</span>
                                 <span class="s2">&quot;the present figure&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c1"># Normalize correct ijk values to (i, j, k) here so that</span>
            <span class="c1"># add_subplot(211) == add_subplot(2, 1, 1).  Invalid values will</span>
            <span class="c1"># trigger errors later (via SubplotSpec._from_subplot_args).</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Integral</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="mi">100</span> <span class="o">&lt;=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">999</span><span class="p">):</span>
                <span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="n">projection_class</span><span class="p">,</span> <span class="n">pkw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_projection_requirements</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">projection_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">pkw</span><span class="p">)</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">projection_class</span><span class="p">,</span> <span class="n">pkw</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_axes_internal</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_add_axes_internal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Private helper for `add_axes` and `add_subplot`.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localaxes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_localaxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delaxes</span>
        <span class="c1"># this is to support plt.subplot&#39;s re-selection logic</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">_projection_init</span> <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>
        <span class="k">return</span> <span class="n">ax</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">subplots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">subplot_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a set of subplots to this figure.</span>

<span class="sd">        This utility wrapper makes it convenient to create common layouts of</span>
<span class="sd">        subplots in a single call.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nrows, ncols : int, default: 1</span>
<span class="sd">            Number of rows/columns of the subplot grid.</span>

<span class="sd">        sharex, sharey : bool or {&#39;none&#39;, &#39;all&#39;, &#39;row&#39;, &#39;col&#39;}, default: False</span>
<span class="sd">            Controls sharing of x-axis (*sharex*) or y-axis (*sharey*):</span>

<span class="sd">            - True or &#39;all&#39;: x- or y-axis will be shared among all subplots.</span>
<span class="sd">            - False or &#39;none&#39;: each subplot x- or y-axis will be independent.</span>
<span class="sd">            - &#39;row&#39;: each subplot row will share an x- or y-axis.</span>
<span class="sd">            - &#39;col&#39;: each subplot column will share an x- or y-axis.</span>

<span class="sd">            When subplots have a shared x-axis along a column, only the x tick</span>
<span class="sd">            labels of the bottom subplot are created. Similarly, when subplots</span>
<span class="sd">            have a shared y-axis along a row, only the y tick labels of the</span>
<span class="sd">            first column subplot are created. To later turn other subplots&#39;</span>
<span class="sd">            ticklabels on, use `~matplotlib.axes.Axes.tick_params`.</span>

<span class="sd">            When subplots have a shared axis that has units, calling</span>
<span class="sd">            `.Axis.set_units` will update each axis with the new units.</span>

<span class="sd">            Note that it is not possible to unshare axes.</span>

<span class="sd">        squeeze : bool, default: True</span>
<span class="sd">            - If True, extra dimensions are squeezed out from the returned</span>
<span class="sd">              array of Axes:</span>

<span class="sd">              - if only one subplot is constructed (nrows=ncols=1), the</span>
<span class="sd">                resulting single Axes object is returned as a scalar.</span>
<span class="sd">              - for Nx1 or 1xM subplots, the returned object is a 1D numpy</span>
<span class="sd">                object array of Axes objects.</span>
<span class="sd">              - for NxM, subplots with N&gt;1 and M&gt;1 are returned as a 2D array.</span>

<span class="sd">            - If False, no squeezing at all is done: the returned Axes object</span>
<span class="sd">              is always a 2D array containing Axes instances, even if it ends</span>
<span class="sd">              up being 1x1.</span>

<span class="sd">        width_ratios : array-like of length *ncols*, optional</span>
<span class="sd">            Defines the relative widths of the columns. Each column gets a</span>
<span class="sd">            relative width of ``width_ratios[i] / sum(width_ratios)``.</span>
<span class="sd">            If not given, all columns will have the same width.  Equivalent</span>
<span class="sd">            to ``gridspec_kw={&#39;width_ratios&#39;: [...]}``.</span>

<span class="sd">        height_ratios : array-like of length *nrows*, optional</span>
<span class="sd">            Defines the relative heights of the rows. Each row gets a</span>
<span class="sd">            relative height of ``height_ratios[i] / sum(height_ratios)``.</span>
<span class="sd">            If not given, all rows will have the same height. Equivalent</span>
<span class="sd">            to ``gridspec_kw={&#39;height_ratios&#39;: [...]}``.</span>

<span class="sd">        subplot_kw : dict, optional</span>
<span class="sd">            Dict with keywords passed to the `.Figure.add_subplot` call used to</span>
<span class="sd">            create each subplot.</span>

<span class="sd">        gridspec_kw : dict, optional</span>
<span class="sd">            Dict with keywords passed to the</span>
<span class="sd">            `~matplotlib.gridspec.GridSpec` constructor used to create</span>
<span class="sd">            the grid the subplots are placed on.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~.axes.Axes` or array of Axes</span>
<span class="sd">            Either a single `~matplotlib.axes.Axes` object or an array of Axes</span>
<span class="sd">            objects if more than one subplot was created. The dimensions of the</span>
<span class="sd">            resulting array can be controlled with the *squeeze* keyword, see</span>
<span class="sd">            above.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .pyplot.subplots</span>
<span class="sd">        .Figure.add_subplot</span>
<span class="sd">        .pyplot.subplot</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            # First create some toy data:</span>
<span class="sd">            x = np.linspace(0, 2*np.pi, 400)</span>
<span class="sd">            y = np.sin(x**2)</span>

<span class="sd">            # Create a figure</span>
<span class="sd">            fig = plt.figure()</span>

<span class="sd">            # Create a subplot</span>
<span class="sd">            ax = fig.subplots()</span>
<span class="sd">            ax.plot(x, y)</span>
<span class="sd">            ax.set_title(&#39;Simple plot&#39;)</span>

<span class="sd">            # Create two subplots and unpack the output array immediately</span>
<span class="sd">            ax1, ax2 = fig.subplots(1, 2, sharey=True)</span>
<span class="sd">            ax1.plot(x, y)</span>
<span class="sd">            ax1.set_title(&#39;Sharing Y axis&#39;)</span>
<span class="sd">            ax2.scatter(x, y)</span>

<span class="sd">            # Create four polar Axes and access them through the returned array</span>
<span class="sd">            axes = fig.subplots(2, 2, subplot_kw=dict(projection=&#39;polar&#39;))</span>
<span class="sd">            axes[0, 0].plot(x, y)</span>
<span class="sd">            axes[1, 1].scatter(x, y)</span>

<span class="sd">            # Share an X-axis with each column of subplots</span>
<span class="sd">            fig.subplots(2, 2, sharex=&#39;col&#39;)</span>

<span class="sd">            # Share a Y-axis with each row of subplots</span>
<span class="sd">            fig.subplots(2, 2, sharey=&#39;row&#39;)</span>

<span class="sd">            # Share both X- and Y-axes with all subplots</span>
<span class="sd">            fig.subplots(2, 2, sharex=&#39;all&#39;, sharey=&#39;all&#39;)</span>

<span class="sd">            # Note that this is the same as</span>
<span class="sd">            fig.subplots(2, 2, sharex=True, sharey=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">gridspec_kw</span> <span class="ow">or</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">height_ratios</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;height_ratios&#39;</span> <span class="ow">in</span> <span class="n">gridspec_kw</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;height_ratios&#39; must not be defined both as &quot;</span>
                                 <span class="s2">&quot;parameter and as key in &#39;gridspec_kw&#39;&quot;</span><span class="p">)</span>
            <span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">height_ratios</span>
        <span class="k">if</span> <span class="n">width_ratios</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;width_ratios&#39;</span> <span class="ow">in</span> <span class="n">gridspec_kw</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;width_ratios&#39; must not be defined both as &quot;</span>
                                 <span class="s2">&quot;parameter and as key in &#39;gridspec_kw&#39;&quot;</span><span class="p">)</span>
            <span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">width_ratios</span>

        <span class="n">gs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">gridspec_kw</span><span class="p">)</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="n">squeeze</span><span class="p">,</span>
                          <span class="n">subplot_kw</span><span class="o">=</span><span class="n">subplot_kw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delaxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove the `~.axes.Axes` *ax* from the figure; update the current Axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remove_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">owners</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localaxes</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_remove_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">owners</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Common helper for removal of standard Axes (via delaxes) and of child Axes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ax : `~.AxesBase`</span>
<span class="sd">            The Axes to remove.</span>
<span class="sd">        owners</span>
<span class="sd">            List of objects (list or _AxesStack) &quot;owning&quot; the Axes, from which the Axes</span>
<span class="sd">            will be remove()d.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">owner</span> <span class="ow">in</span> <span class="n">owners</span><span class="p">:</span>
            <span class="n">owner</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;_axes_change_event&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">release_mouse</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">_axis_names</span><span class="p">:</span>  <span class="c1"># Break link between any shared Axes</span>
            <span class="n">grouper</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">_shared_axes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">siblings</span> <span class="o">=</span> <span class="p">[</span><span class="n">other</span> <span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">grouper</span><span class="o">.</span><span class="n">get_siblings</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">siblings</span><span class="p">:</span>  <span class="c1"># Axes was not shared along this axis; we&#39;re done.</span>
                <span class="k">continue</span>
            <span class="n">grouper</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="c1"># Formatters and locators may previously have been associated with the now</span>
            <span class="c1"># removed axis.  Update them to point to an axis still there (we can pick</span>
            <span class="c1"># any of them, and use the first sibling).</span>
            <span class="n">remaining_axis</span> <span class="o">=</span> <span class="n">siblings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_axis_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="n">remaining_axis</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">remaining_axis</span><span class="p">)</span>
            <span class="n">remaining_axis</span><span class="o">.</span><span class="n">get_major_locator</span><span class="p">()</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">remaining_axis</span><span class="p">)</span>
            <span class="n">remaining_axis</span><span class="o">.</span><span class="n">get_minor_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">remaining_axis</span><span class="p">)</span>
            <span class="n">remaining_axis</span><span class="o">.</span><span class="n">get_minor_locator</span><span class="p">()</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">remaining_axis</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">_twinned_axes</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>  <span class="c1"># Break link between any twinned Axes.</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_observers</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clear the figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keep_observers : bool, default: False</span>
<span class="sd">            Set *keep_observers* to True if, for example,</span>
<span class="sd">            a gui widget is tracking the Axes in the figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># first clear the Axes in any subfigures</span>
        <span class="k">for</span> <span class="n">subfig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span><span class="p">:</span>
            <span class="n">subfig</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">keep_observers</span><span class="o">=</span><span class="n">keep_observers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>  <span class="c1"># Iterate over the copy.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>  <span class="c1"># Remove ax from self._axstack.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">artists</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_observers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">CallbackRegistry</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_suptitle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_supxlabel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_supylabel</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># synonym for `clear`.</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">clf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_observers</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        [*Discouraged*] Alias for the `clear()` method.</span>

<span class="sd">        .. admonition:: Discouraged</span>

<span class="sd">            The use of ``clf()`` is discouraged. Use ``clear()`` instead.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        keep_observers : bool, default: False</span>
<span class="sd">            Set *keep_observers* to True if, for example,</span>
<span class="sd">            a gui widget is tracking the Axes in the figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">keep_observers</span><span class="o">=</span><span class="n">keep_observers</span><span class="p">)</span>

    <span class="c1"># Note: the docstring below is modified with replace for the pyplot</span>
    <span class="c1"># version of this function because the method name differs (plt.figlegend)</span>
    <span class="c1"># the replacements are:</span>
    <span class="c1">#    &quot; legend(&quot; -&gt; &quot; figlegend(&quot; for the signatures</span>
    <span class="c1">#    &quot;fig.legend(&quot; -&gt; &quot;plt.figlegend&quot; for the code examples</span>
    <span class="c1">#    &quot;ax.plot&quot; -&gt; &quot;plt.plot&quot; for consistency in using pyplot when able</span>
    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Place a legend on the figure.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">            legend()</span>
<span class="sd">            legend(handles, labels)</span>
<span class="sd">            legend(handles=handles)</span>
<span class="sd">            legend(labels)</span>

<span class="sd">        The call signatures correspond to the following different ways to use</span>
<span class="sd">        this method:</span>

<span class="sd">        **1. Automatic detection of elements to be shown in the legend**</span>

<span class="sd">        The elements to be added to the legend are automatically determined,</span>
<span class="sd">        when you do not pass in any extra arguments.</span>

<span class="sd">        In this case, the labels are taken from the artist. You can specify</span>
<span class="sd">        them either at artist creation or by calling the</span>
<span class="sd">        :meth:`~.Artist.set_label` method on the artist::</span>

<span class="sd">            ax.plot([1, 2, 3], label=&#39;Inline label&#39;)</span>
<span class="sd">            fig.legend()</span>

<span class="sd">        or::</span>

<span class="sd">            line, = ax.plot([1, 2, 3])</span>
<span class="sd">            line.set_label(&#39;Label via method&#39;)</span>
<span class="sd">            fig.legend()</span>

<span class="sd">        Specific lines can be excluded from the automatic legend element</span>
<span class="sd">        selection by defining a label starting with an underscore.</span>
<span class="sd">        This is default for all artists, so calling `.Figure.legend` without</span>
<span class="sd">        any arguments and without setting the labels manually will result in</span>
<span class="sd">        no legend being drawn.</span>


<span class="sd">        **2. Explicitly listing the artists and labels in the legend**</span>

<span class="sd">        For full control of which artists have a legend entry, it is possible</span>
<span class="sd">        to pass an iterable of legend artists followed by an iterable of</span>
<span class="sd">        legend labels respectively::</span>

<span class="sd">            fig.legend([line1, line2, line3], [&#39;label1&#39;, &#39;label2&#39;, &#39;label3&#39;])</span>


<span class="sd">        **3. Explicitly listing the artists in the legend**</span>

<span class="sd">        This is similar to 2, but the labels are taken from the artists&#39;</span>
<span class="sd">        label properties. Example::</span>

<span class="sd">            line1, = ax1.plot([1, 2, 3], label=&#39;label1&#39;)</span>
<span class="sd">            line2, = ax2.plot([1, 2, 3], label=&#39;label2&#39;)</span>
<span class="sd">            fig.legend(handles=[line1, line2])</span>


<span class="sd">        **4. Labeling existing plot elements**</span>

<span class="sd">        .. admonition:: Discouraged</span>

<span class="sd">            This call signature is discouraged, because the relation between</span>
<span class="sd">            plot elements and labels is only implicit by their order and can</span>
<span class="sd">            easily be mixed up.</span>

<span class="sd">        To make a legend for all artists on all Axes, call this function with</span>
<span class="sd">        an iterable of strings, one for each legend item. For example::</span>

<span class="sd">            fig, (ax1, ax2) = plt.subplots(1, 2)</span>
<span class="sd">            ax1.plot([1, 3, 5], color=&#39;blue&#39;)</span>
<span class="sd">            ax2.plot([2, 4, 6], color=&#39;red&#39;)</span>
<span class="sd">            fig.legend([&#39;the blues&#39;, &#39;the reds&#39;])</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        handles : list of `.Artist`, optional</span>
<span class="sd">            A list of Artists (lines, patches) to be added to the legend.</span>
<span class="sd">            Use this together with *labels*, if you need full control on what</span>
<span class="sd">            is shown in the legend and the automatic mechanism described above</span>
<span class="sd">            is not sufficient.</span>

<span class="sd">            The length of handles and labels should be the same in this</span>
<span class="sd">            case. If they are not, they are truncated to the smaller length.</span>

<span class="sd">        labels : list of str, optional</span>
<span class="sd">            A list of labels to show next to the artists.</span>
<span class="sd">            Use this together with *handles*, if you need full control on what</span>
<span class="sd">            is shown in the legend and the automatic mechanism described above</span>
<span class="sd">            is not sufficient.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~matplotlib.legend.Legend`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(_legend_kw_figure)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Axes.legend</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Some artists are not supported by this function.  See</span>
<span class="sd">        :ref:`legend_guide` for details.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">mlegend</span><span class="o">.</span><span class="n">_parse_legend_args</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># explicitly set the bbox transform if the user hasn&#39;t.</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;bbox_transform&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">transSubfigure</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">mlegend</span><span class="o">.</span><span class="n">Legend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="n">l</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="o">.</span><span class="n">remove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">l</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add text to figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x, y : float</span>
<span class="sd">            The position to place the text. By default, this is in figure</span>
<span class="sd">            coordinates, floats in [0, 1]. The coordinate system can be changed</span>
<span class="sd">            using the *transform* keyword.</span>

<span class="sd">        s : str</span>
<span class="sd">            The text string.</span>

<span class="sd">        fontdict : dict, optional</span>
<span class="sd">            A dictionary to override the default text properties. If not given,</span>
<span class="sd">            the defaults are determined by :rc:`font.*`. Properties passed as</span>
<span class="sd">            *kwargs* override the corresponding ones given in *fontdict*.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `~.text.Text`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `~matplotlib.text.Text` properties</span>
<span class="sd">            Other miscellaneous text parameters.</span>

<span class="sd">            %(Text:kwdoc)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Axes.text</span>
<span class="sd">        .pyplot.text</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">effective_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;transform&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">transSubfigure</span><span class="p">,</span>
            <span class="o">**</span><span class="p">(</span><span class="n">fontdict</span> <span class="k">if</span> <span class="n">fontdict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">Text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">effective_kwargs</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">text</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">remove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">text</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">colorbar</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">mappable</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gridspec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a colorbar to a plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mappable</span>
<span class="sd">            The `matplotlib.cm.ScalarMappable` (i.e., `.AxesImage`,</span>
<span class="sd">            `.ContourSet`, etc.) described by this colorbar.  This argument is</span>
<span class="sd">            mandatory for the `.Figure.colorbar` method but optional for the</span>
<span class="sd">            `.pyplot.colorbar` function, which sets the default to the current</span>
<span class="sd">            image.</span>

<span class="sd">            Note that one can create a `.ScalarMappable` &quot;on-the-fly&quot; to</span>
<span class="sd">            generate colorbars not attached to a previously drawn artist, e.g.</span>
<span class="sd">            ::</span>

<span class="sd">                fig.colorbar(cm.ScalarMappable(norm=norm, cmap=cmap), ax=ax)</span>

<span class="sd">        cax : `~matplotlib.axes.Axes`, optional</span>
<span class="sd">            Axes into which the colorbar will be drawn.  If `None`, then a new</span>
<span class="sd">            Axes is created and the space for it will be stolen from the Axes(s)</span>
<span class="sd">            specified in *ax*.</span>

<span class="sd">        ax : `~matplotlib.axes.Axes` or iterable or `numpy.ndarray` of Axes, optional</span>
<span class="sd">            The one or more parent Axes from which space for a new colorbar Axes</span>
<span class="sd">            will be stolen. This parameter is only used if *cax* is not set.</span>

<span class="sd">            Defaults to the Axes that contains the mappable used to create the</span>
<span class="sd">            colorbar.</span>

<span class="sd">        use_gridspec : bool, optional</span>
<span class="sd">            If *cax* is ``None``, a new *cax* is created as an instance of</span>
<span class="sd">            Axes.  If *ax* is positioned with a subplotspec and *use_gridspec*</span>
<span class="sd">            is ``True``, then *cax* is also positioned with a subplotspec.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        colorbar : `~matplotlib.colorbar.Colorbar`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        %(_make_axes_kw_doc)s</span>
<span class="sd">        %(_colormap_kw_doc)s</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If *mappable* is a `~.contour.ContourSet`, its *extend* kwarg is</span>
<span class="sd">        included automatically.</span>

<span class="sd">        The *shrink* kwarg provides a simple way to scale the colorbar with</span>
<span class="sd">        respect to the Axes. Note that if *cax* is specified, it determines the</span>
<span class="sd">        size of the colorbar, and *shrink* and *aspect* are ignored.</span>

<span class="sd">        For more precise control, you can manually specify the positions of the</span>
<span class="sd">        axes objects in which the mappable and the colorbar are drawn.  In this</span>
<span class="sd">        case, do not use any of the Axes properties kwargs.</span>

<span class="sd">        It is known that some vector graphics viewers (svg and pdf) render</span>
<span class="sd">        white gaps between segments of the colorbar.  This is due to bugs in</span>
<span class="sd">        the viewers, not Matplotlib.  As a workaround, the colorbar can be</span>
<span class="sd">        rendered with overlapping segments::</span>

<span class="sd">            cbar = colorbar()</span>
<span class="sd">            cbar.solids.set_edgecolor(&quot;face&quot;)</span>
<span class="sd">            draw()</span>

<span class="sd">        However, this has negative consequences in other circumstances, e.g.</span>
<span class="sd">        with semi-transparent images (alpha &lt; 1) and colorbar extensions;</span>
<span class="sd">        therefore, this workaround is not used by default (see issue #1188).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="s2">&quot;axes&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;Unable to determine Axes to steal space for Colorbar. &#39;</span>
                    <span class="s1">&#39;Either provide the *cax* argument to use as the Axes for &#39;</span>
                    <span class="s1">&#39;the Colorbar, provide the *ax* argument to steal space &#39;</span>
                    <span class="s1">&#39;from it, or add *mappable* to an Axes.&#39;</span><span class="p">)</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="p">(</span>  <span class="c1"># Figure of first Axes; logic copied from make_axes.</span>
                <span class="p">[</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">flat</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">[</span><span class="o">*</span><span class="n">ax</span><span class="p">]</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">[</span><span class="n">ax</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">current_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                    <span class="ow">not</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">colorbar_gridspec</span><span class="p">):</span>
                <span class="n">use_gridspec</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">use_gridspec</span>
                    <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_base</span><span class="o">.</span><span class="n">_AxesBase</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()):</span>
                <span class="n">cax</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">cbar</span><span class="o">.</span><span class="n">make_axes_gridspec</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cax</span><span class="p">,</span> <span class="n">kwargs</span> <span class="o">=</span> <span class="n">cbar</span><span class="o">.</span><span class="n">make_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># make_axes calls add_{axes,subplot} which changes gca; undo that.</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">current_ax</span><span class="p">)</span>
            <span class="n">cax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span> <span class="s2">&quot;get_figure&quot;</span><span class="p">)</span> <span class="ow">and</span>
                <span class="p">(</span><span class="n">mappable_host_fig</span> <span class="o">:=</span> <span class="n">mappable</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1"># Warn in case of mismatch</span>
            <span class="k">if</span> <span class="n">mappable_host_fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span><span class="p">:</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;Adding colorbar to a different Figure &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">mappable_host_fig</span><span class="p">)</span><span class="si">}</span><span class="s1"> than &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span><span class="p">)</span><span class="si">}</span><span class="s1"> which &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;fig.colorbar is called on.&#39;</span><span class="p">)</span>

        <span class="n">NON_COLORBAR_KEYS</span> <span class="o">=</span> <span class="p">[</span>  <span class="c1"># remove kws that cannot be passed to Colorbar</span>
            <span class="s1">&#39;fraction&#39;</span><span class="p">,</span> <span class="s1">&#39;pad&#39;</span><span class="p">,</span> <span class="s1">&#39;shrink&#39;</span><span class="p">,</span> <span class="s1">&#39;aspect&#39;</span><span class="p">,</span> <span class="s1">&#39;anchor&#39;</span><span class="p">,</span> <span class="s1">&#39;panchor&#39;</span><span class="p">]</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">cbar</span><span class="o">.</span><span class="n">Colorbar</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">mappable</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">NON_COLORBAR_KEYS</span><span class="p">})</span>
        <span class="n">cax</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">cb</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">subplots_adjust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">wspace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjust the subplot layout parameters.</span>

<span class="sd">        Unset parameters are left unmodified; initial values are given by</span>
<span class="sd">        :rc:`figure.subplot.[name]`.</span>

<span class="sd">        .. plot:: _embedded_plots/figure_subplots_adjust.py</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        left : float, optional</span>
<span class="sd">            The position of the left edge of the subplots,</span>
<span class="sd">            as a fraction of the figure width.</span>
<span class="sd">        right : float, optional</span>
<span class="sd">            The position of the right edge of the subplots,</span>
<span class="sd">            as a fraction of the figure width.</span>
<span class="sd">        bottom : float, optional</span>
<span class="sd">            The position of the bottom edge of the subplots,</span>
<span class="sd">            as a fraction of the figure height.</span>
<span class="sd">        top : float, optional</span>
<span class="sd">            The position of the top edge of the subplots,</span>
<span class="sd">            as a fraction of the figure height.</span>
<span class="sd">        wspace : float, optional</span>
<span class="sd">            The width of the padding between subplots,</span>
<span class="sd">            as a fraction of the average Axes width.</span>
<span class="sd">        hspace : float, optional</span>
<span class="sd">            The height of the padding between subplots,</span>
<span class="sd">            as a fraction of the average Axes height.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">adjust_compatible</span><span class="p">):</span>
            <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                <span class="s2">&quot;This figure was using a layout engine that is &quot;</span>
                <span class="s2">&quot;incompatible with subplots_adjust and/or tight_layout; &quot;</span>
                <span class="s2">&quot;not calling subplots_adjust.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplotpars</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">_set_position</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">align_xlabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the xlabels of subplots in the same subplot row if label</span>
<span class="sd">        alignment is being done automatically (i.e. the label position is</span>
<span class="sd">        not manually set).</span>

<span class="sd">        Alignment persists for draw events after this is called.</span>

<span class="sd">        If a label is on the bottom, it is aligned with labels on Axes that</span>
<span class="sd">        also have their label on the bottom and that have the same</span>
<span class="sd">        bottom-most subplot row.  If the label is on the top,</span>
<span class="sd">        it is aligned with labels on Axes with the same top-most row.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axs : list of `~matplotlib.axes.Axes`</span>
<span class="sd">            Optional list of (or `~numpy.ndarray`) `~matplotlib.axes.Axes`</span>
<span class="sd">            to align the xlabels.</span>
<span class="sd">            Default is to align all Axes on the figure.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.align_ylabels</span>
<span class="sd">        matplotlib.figure.Figure.align_titles</span>
<span class="sd">        matplotlib.figure.Figure.align_labels</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This assumes that all Axes in ``axs`` are from the same `.GridSpec`,</span>
<span class="sd">        so that their `.SubplotSpec` positions correspond to figure positions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Example with rotated xtick labels::</span>

<span class="sd">            fig, axs = plt.subplots(1, 2)</span>
<span class="sd">            for tick in axs[0].get_xticklabels():</span>
<span class="sd">                tick.set_rotation(55)</span>
<span class="sd">            axs[0].set_xlabel(&#39;XLabel 0&#39;)</span>
<span class="sd">            axs[1].set_xlabel(&#39;XLabel 1&#39;)</span>
<span class="sd">            fig.align_xlabels()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span> <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
            <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39; Working on: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlabel</span><span class="p">())</span>
            <span class="n">rowspan</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">rowspan</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span>  <span class="c1"># top or bottom</span>
            <span class="c1"># Search through other Axes for label positions that are same as</span>
            <span class="c1"># this one and that share the appropriate row number.</span>
            <span class="c1"># Add to a grouper associated with each Axes of siblings.</span>
            <span class="c1"># This list is inspected in `axis.draw` by</span>
            <span class="c1"># `axis._update_label_position`.</span>
            <span class="k">for</span> <span class="n">axc</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axc</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span> <span class="o">==</span> <span class="n">pos</span><span class="p">:</span>
                    <span class="n">rowspanc</span> <span class="o">=</span> <span class="n">axc</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">rowspan</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="s1">&#39;top&#39;</span> <span class="ow">and</span> <span class="n">rowspan</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">rowspanc</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span>
                            <span class="n">pos</span> <span class="o">==</span> <span class="s1">&#39;bottom&#39;</span> <span class="ow">and</span> <span class="n">rowspan</span><span class="o">.</span><span class="n">stop</span> <span class="o">==</span> <span class="n">rowspanc</span><span class="o">.</span><span class="n">stop</span><span class="p">):</span>
                        <span class="c1"># grouper for groups of xlabels to align</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_align_label_groups</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">align_ylabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the ylabels of subplots in the same subplot column if label</span>
<span class="sd">        alignment is being done automatically (i.e. the label position is</span>
<span class="sd">        not manually set).</span>

<span class="sd">        Alignment persists for draw events after this is called.</span>

<span class="sd">        If a label is on the left, it is aligned with labels on Axes that</span>
<span class="sd">        also have their label on the left and that have the same</span>
<span class="sd">        left-most subplot column.  If the label is on the right,</span>
<span class="sd">        it is aligned with labels on Axes with the same right-most column.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axs : list of `~matplotlib.axes.Axes`</span>
<span class="sd">            Optional list (or `~numpy.ndarray`) of `~matplotlib.axes.Axes`</span>
<span class="sd">            to align the ylabels.</span>
<span class="sd">            Default is to align all Axes on the figure.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.align_xlabels</span>
<span class="sd">        matplotlib.figure.Figure.align_titles</span>
<span class="sd">        matplotlib.figure.Figure.align_labels</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This assumes that all Axes in ``axs`` are from the same `.GridSpec`,</span>
<span class="sd">        so that their `.SubplotSpec` positions correspond to figure positions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Example with large yticks labels::</span>

<span class="sd">            fig, axs = plt.subplots(2, 1)</span>
<span class="sd">            axs[0].plot(np.arange(0, 1000, 50))</span>
<span class="sd">            axs[0].set_ylabel(&#39;YLabel 0&#39;)</span>
<span class="sd">            axs[1].set_ylabel(&#39;YLabel 1&#39;)</span>
<span class="sd">            fig.align_ylabels()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span> <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
            <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39; Working on: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">())</span>
            <span class="n">colspan</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">colspan</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span>  <span class="c1"># left or right</span>
            <span class="c1"># Search through other Axes for label positions that are same as</span>
            <span class="c1"># this one and that share the appropriate column number.</span>
            <span class="c1"># Add to a list associated with each Axes of siblings.</span>
            <span class="c1"># This list is inspected in `axis.draw` by</span>
            <span class="c1"># `axis._update_label_position`.</span>
            <span class="k">for</span> <span class="n">axc</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axc</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_label_position</span><span class="p">()</span> <span class="o">==</span> <span class="n">pos</span><span class="p">:</span>
                    <span class="n">colspanc</span> <span class="o">=</span> <span class="n">axc</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">colspan</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span> <span class="ow">and</span> <span class="n">colspan</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">colspanc</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span>
                            <span class="n">pos</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span> <span class="ow">and</span> <span class="n">colspan</span><span class="o">.</span><span class="n">stop</span> <span class="o">==</span> <span class="n">colspanc</span><span class="o">.</span><span class="n">stop</span><span class="p">):</span>
                        <span class="c1"># grouper for groups of ylabels to align</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_align_label_groups</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">align_titles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the titles of subplots in the same subplot row if title</span>
<span class="sd">        alignment is being done automatically (i.e. the title position is</span>
<span class="sd">        not manually set).</span>

<span class="sd">        Alignment persists for draw events after this is called.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axs : list of `~matplotlib.axes.Axes`</span>
<span class="sd">            Optional list of (or ndarray) `~matplotlib.axes.Axes`</span>
<span class="sd">            to align the titles.</span>
<span class="sd">            Default is to align all Axes on the figure.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.align_xlabels</span>
<span class="sd">        matplotlib.figure.Figure.align_ylabels</span>
<span class="sd">        matplotlib.figure.Figure.align_labels</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This assumes that all Axes in ``axs`` are from the same `.GridSpec`,</span>
<span class="sd">        so that their `.SubplotSpec` positions correspond to figure positions.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Example with titles::</span>

<span class="sd">            fig, axs = plt.subplots(1, 2)</span>
<span class="sd">            axs[0].set_aspect(&#39;equal&#39;)</span>
<span class="sd">            axs[0].set_title(&#39;Title 0&#39;)</span>
<span class="sd">            axs[1].set_title(&#39;Title 1&#39;)</span>
<span class="sd">            fig.align_titles()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">axs</span><span class="p">)</span> <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
            <span class="n">_log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39; Working on: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_title</span><span class="p">())</span>
            <span class="n">rowspan</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">rowspan</span>
            <span class="k">for</span> <span class="n">axc</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
                <span class="n">rowspanc</span> <span class="o">=</span> <span class="n">axc</span><span class="o">.</span><span class="n">get_subplotspec</span><span class="p">()</span><span class="o">.</span><span class="n">rowspan</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rowspan</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">rowspanc</span><span class="o">.</span><span class="n">start</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_align_label_groups</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">axc</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">align_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Align the xlabels and ylabels of subplots with the same subplots</span>
<span class="sd">        row or column (respectively) if label alignment is being</span>
<span class="sd">        done automatically (i.e. the label position is not manually set).</span>

<span class="sd">        Alignment persists for draw events after this is called.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axs : list of `~matplotlib.axes.Axes`</span>
<span class="sd">            Optional list (or `~numpy.ndarray`) of `~matplotlib.axes.Axes`</span>
<span class="sd">            to align the labels.</span>
<span class="sd">            Default is to align all Axes on the figure.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.align_xlabels</span>
<span class="sd">        matplotlib.figure.Figure.align_ylabels</span>
<span class="sd">        matplotlib.figure.Figure.align_titles</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This assumes that all Axes in ``axs`` are from the same `.GridSpec`,</span>
<span class="sd">        so that their `.SubplotSpec` positions correspond to figure positions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">align_xlabels</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">align_ylabels</span><span class="p">(</span><span class="n">axs</span><span class="o">=</span><span class="n">axs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_gridspec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Low-level API for creating a `.GridSpec` that has this figure as a parent.</span>

<span class="sd">        This is a low-level API, allowing you to create a gridspec and</span>
<span class="sd">        subsequently add subplots based on the gridspec. Most users do</span>
<span class="sd">        not need that freedom and should use the higher-level methods</span>
<span class="sd">        `~.Figure.subplots` or `~.Figure.subplot_mosaic`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nrows : int, default: 1</span>
<span class="sd">            Number of rows in grid.</span>

<span class="sd">        ncols : int, default: 1</span>
<span class="sd">            Number of columns in grid.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `.GridSpec`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Keyword arguments are passed to `.GridSpec`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.pyplot.subplots</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Adding a subplot that spans two rows::</span>

<span class="sd">            fig = plt.figure()</span>
<span class="sd">            gs = fig.add_gridspec(2, 2)</span>
<span class="sd">            ax1 = fig.add_subplot(gs[0, 0])</span>
<span class="sd">            ax2 = fig.add_subplot(gs[1, 0])</span>
<span class="sd">            # spans two rows:</span>
<span class="sd">            ax3 = fig.add_subplot(gs[:, 1])</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># pop in case user has added this...</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">subfigures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">wspace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">width_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a set of subfigures to this figure or subfigure.</span>

<span class="sd">        A subfigure has the same artist methods as a figure, and is logically</span>
<span class="sd">        the same as a figure, but cannot print itself.</span>
<span class="sd">        See :doc:`/gallery/subplots_axes_and_figures/subfigures`.</span>

<span class="sd">        .. versionchanged:: 3.10</span>
<span class="sd">            subfigures are now added in row-major order.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nrows, ncols : int, default: 1</span>
<span class="sd">            Number of rows/columns of the subfigure grid.</span>

<span class="sd">        squeeze : bool, default: True</span>
<span class="sd">            If True, extra dimensions are squeezed out from the returned</span>
<span class="sd">            array of subfigures.</span>

<span class="sd">        wspace, hspace : float, default: None</span>
<span class="sd">            The amount of width/height reserved for space between subfigures,</span>
<span class="sd">            expressed as a fraction of the average subfigure width/height.</span>
<span class="sd">            If not given, the values will be inferred from rcParams if using</span>
<span class="sd">            constrained layout (see `~.ConstrainedLayoutEngine`), or zero if</span>
<span class="sd">            not using a layout engine.</span>

<span class="sd">        width_ratios : array-like of length *ncols*, optional</span>
<span class="sd">            Defines the relative widths of the columns. Each column gets a</span>
<span class="sd">            relative width of ``width_ratios[i] / sum(width_ratios)``.</span>
<span class="sd">            If not given, all columns will have the same width.</span>

<span class="sd">        height_ratios : array-like of length *nrows*, optional</span>
<span class="sd">            Defines the relative heights of the rows. Each row gets a</span>
<span class="sd">            relative height of ``height_ratios[i] / sum(height_ratios)``.</span>
<span class="sd">            If not given, all rows will have the same height.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figure</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                      <span class="n">wspace</span><span class="o">=</span><span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="n">hspace</span><span class="p">,</span>
                      <span class="n">width_ratios</span><span class="o">=</span><span class="n">width_ratios</span><span class="p">,</span>
                      <span class="n">height_ratios</span><span class="o">=</span><span class="n">height_ratios</span><span class="p">,</span>
                      <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">sfarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
                <span class="n">sfarr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_subfigure</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">wspace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span>
                                                 <span class="n">hspace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1"># Gridspec wspace and hspace is ignored on subfigure instantiation,</span>
            <span class="c1"># and no space is left.  So need to account for it here if required.</span>
            <span class="n">bottoms</span><span class="p">,</span> <span class="n">tops</span><span class="p">,</span> <span class="n">lefts</span><span class="p">,</span> <span class="n">rights</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">get_grid_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">sfrow</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">top</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sfarr</span><span class="p">,</span> <span class="n">bottoms</span><span class="p">,</span> <span class="n">tops</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">sf</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sfrow</span><span class="p">,</span> <span class="n">lefts</span><span class="p">,</span> <span class="n">rights</span><span class="p">):</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_extents</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
                    <span class="n">sf</span><span class="o">.</span><span class="n">_redo_transform_rel_fig</span><span class="p">(</span><span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">squeeze</span><span class="p">:</span>
            <span class="c1"># Discarding unneeded dimensions that equal 1.  If we only have one</span>
            <span class="c1"># subfigure, just return it instead of a 1-element array.</span>
            <span class="k">return</span> <span class="n">sfarr</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">if</span> <span class="n">sfarr</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">sfarr</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Returned axis array will be always 2-d, even if nrows=ncols=1.</span>
            <span class="k">return</span> <span class="n">sfarr</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_subfigure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subplotspec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a `.SubFigure` to the figure as part of a subplot arrangement.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        subplotspec : `.gridspec.SubplotSpec`</span>
<span class="sd">            Defines the region in a parent gridspec where the subfigure will</span>
<span class="sd">            be placed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `.SubFigure`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Are passed to the `.SubFigure` object.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Figure.subfigures</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sf</span> <span class="o">=</span> <span class="n">SubFigure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subplotspec</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">sf</span><span class="p">]</span>
        <span class="n">sf</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span><span class="o">.</span><span class="n">remove</span>
        <span class="n">sf</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">sf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sca</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the current Axes to be *a* and return *a*.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">bubble</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;_axes_change_event&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">a</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">gca</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current Axes.</span>

<span class="sd">        If there is currently no Axes on this Figure, a new one is created</span>
<span class="sd">        using `.Figure.add_subplot`.  (To test whether there is currently an</span>
<span class="sd">        Axes on a Figure, check whether ``figure.axes`` is empty.  To test</span>
<span class="sd">        whether there is currently a Figure on the pyplot figure stack, check</span>
<span class="sd">        whether `.pyplot.get_fignums()` is empty.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ax</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_gci</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Helper for `~matplotlib.pyplot.gci`.  Do not use elsewhere.</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the current colorable artist.</span>

<span class="sd">        Specifically, returns the current `.ScalarMappable` instance (`.Image`</span>
<span class="sd">        created by `imshow` or `figimage`, `.Collection` created by `pcolor` or</span>
<span class="sd">        `scatter`, etc.), or *None* if no such instance has been defined.</span>

<span class="sd">        The current image is an attribute of the current Axes, or the nearest</span>
<span class="sd">        earlier Axes in the current figure that contains an image.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Historically, the only colorable artists were images; hence the name</span>
<span class="sd">        ``gci`` (get current image).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Look first for an image in the current Axes.</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">_gci</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">im</span>
        <span class="c1"># If there is no image in the current Axes, search for</span>
        <span class="c1"># one in a previously created Axes.  Whether this makes</span>
        <span class="c1"># sense is debatable, but it is the documented behavior.</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">_gci</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">im</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">im</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_projection_requirements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">axes_class</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                         <span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the args/kwargs to add_axes/add_subplot/gca, returning::</span>

<span class="sd">            (axes_proj_class, proj_class_kwargs)</span>

<span class="sd">        which can be used for new Axes initialization/identification.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axes_class</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">polar</span> <span class="ow">or</span> <span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot combine &#39;axes_class&#39; and &#39;projection&#39; or &#39;polar&#39;&quot;</span><span class="p">)</span>
            <span class="n">projection_class</span> <span class="o">=</span> <span class="n">axes_class</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">polar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">projection</span> <span class="o">!=</span> <span class="s1">&#39;polar&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;polar=</span><span class="si">{</span><span class="n">polar</span><span class="si">}</span><span class="s2">, yet projection=</span><span class="si">{</span><span class="n">projection</span><span class="si">!r}</span><span class="s2">. &quot;</span>
                        <span class="s2">&quot;Only one of these arguments should be supplied.&quot;</span>
                    <span class="p">)</span>
                <span class="n">projection</span> <span class="o">=</span> <span class="s1">&#39;polar&#39;</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">projection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">projection_class</span> <span class="o">=</span> <span class="n">projections</span><span class="o">.</span><span class="n">get_projection_class</span><span class="p">(</span><span class="n">projection</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="s1">&#39;_as_mpl_axes&#39;</span><span class="p">):</span>
                <span class="n">projection_class</span><span class="p">,</span> <span class="n">extra_kwargs</span> <span class="o">=</span> <span class="n">projection</span><span class="o">.</span><span class="n">_as_mpl_axes</span><span class="p">()</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">extra_kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;projection must be a string, None or implement a &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;_as_mpl_axes method, not </span><span class="si">{</span><span class="n">projection</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">projection_class</span><span class="p">,</span> <span class="n">kwargs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_default_bbox_extra_artists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of Artists typically used in `.Figure.get_tightbbox`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bbox_artists</span> <span class="o">=</span> <span class="p">[</span><span class="n">artist</span> <span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">artist</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="ow">and</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_in_layout</span><span class="p">())]</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                <span class="n">bbox_artists</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_default_bbox_extra_artists</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">bbox_artists</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_tightbbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">bbox_extra_artists</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a (tight) bounding box of the figure *in inches*.</span>

<span class="sd">        Note that `.FigureBase` differs from all other artists, which return</span>
<span class="sd">        their `.Bbox` in pixels.</span>

<span class="sd">        Artists that have ``artist.set_in_layout(False)`` are not included</span>
<span class="sd">        in the bbox.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        renderer : `.RendererBase` subclass</span>
<span class="sd">            Renderer that will be used to draw the figures (i.e.</span>
<span class="sd">            ``fig.canvas.get_renderer()``)</span>

<span class="sd">        bbox_extra_artists : list of `.Artist` or ``None``</span>
<span class="sd">            List of artists to include in the tight bounding box.  If</span>
<span class="sd">            ``None`` (default), then all artist children of each Axes are</span>
<span class="sd">            included in the tight bounding box.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `.BboxBase`</span>
<span class="sd">            containing the bounding box (in figure inches).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">_get_renderer</span><span class="p">()</span>

        <span class="n">bb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">bbox_extra_artists</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">artists</span> <span class="o">=</span> <span class="p">[</span><span class="n">artist</span> <span class="k">for</span> <span class="n">artist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
                       <span class="k">if</span> <span class="p">(</span><span class="n">artist</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">and</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span>
                           <span class="ow">and</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_in_layout</span><span class="p">())]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">artists</span> <span class="o">=</span> <span class="n">bbox_extra_artists</span>

        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">artists</span><span class="p">:</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
                <span class="c1"># some Axes don&#39;t take the bbox_extra_artists kwarg so we</span>
                <span class="c1"># need this conditional....</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span>
                        <span class="n">renderer</span><span class="p">,</span> <span class="n">bbox_extra_artists</span><span class="o">=</span><span class="n">bbox_extra_artists</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
                <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bb</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
                  <span class="ow">and</span> <span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">width</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">height</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">))]</span>

        <span class="n">isfigure</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;bbox_inches&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">isfigure</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># subfigures do not have bbox_inches, but do have a bbox</span>
                <span class="n">bb</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">]</span>

        <span class="n">_bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">bb</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isfigure</span><span class="p">:</span>
            <span class="c1"># transform from pixels to inches...</span>
            <span class="n">_bbox</span> <span class="o">=</span> <span class="n">TransformedBbox</span><span class="p">(</span><span class="n">_bbox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">_bbox</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_norm_per_subplot_kw</span><span class="p">(</span><span class="n">per_subplot_kw</span><span class="p">):</span>
        <span class="n">expanded</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">per_subplot_kw</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">sub_key</span> <span class="ow">in</span> <span class="n">expanded</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The key </span><span class="si">{</span><span class="n">sub_key</span><span class="si">!r}</span><span class="s1"> appears multiple times.&#39;</span><span class="p">)</span>
                    <span class="n">expanded</span><span class="p">[</span><span class="n">sub_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">expanded</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The key </span><span class="si">{</span><span class="n">k</span><span class="si">!r}</span><span class="s1"> appears multiple times.&#39;</span><span class="p">)</span>
                <span class="n">expanded</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">expanded</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_normalize_grid_string</span><span class="p">(</span><span class="n">layout</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">layout</span><span class="p">:</span>
            <span class="c1"># single-line string</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">layout</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># multi-line string</span>
            <span class="n">layout</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">layout</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">subplot_mosaic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mosaic</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">width_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">empty_sentinel</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
                       <span class="n">subplot_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">per_subplot_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a layout of Axes based on ASCII art or nested lists.</span>

<span class="sd">        This is a helper function to build complex GridSpec layouts visually.</span>

<span class="sd">        See :ref:`mosaic`</span>
<span class="sd">        for an example and full API documentation</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mosaic : list of list of {hashable or nested} or str</span>

<span class="sd">            A visual layout of how you want your Axes to be arranged</span>
<span class="sd">            labeled as strings.  For example ::</span>

<span class="sd">               x = [[&#39;A panel&#39;, &#39;A panel&#39;, &#39;edge&#39;],</span>
<span class="sd">                    [&#39;C panel&#39;, &#39;.&#39;,       &#39;edge&#39;]]</span>

<span class="sd">            produces 4 Axes:</span>

<span class="sd">            - &#39;A panel&#39; which is 1 row high and spans the first two columns</span>
<span class="sd">            - &#39;edge&#39; which is 2 rows high and is on the right edge</span>
<span class="sd">            - &#39;C panel&#39; which in 1 row and 1 column wide in the bottom left</span>
<span class="sd">            - a blank space 1 row and 1 column wide in the bottom center</span>

<span class="sd">            Any of the entries in the layout can be a list of lists</span>
<span class="sd">            of the same form to create nested layouts.</span>

<span class="sd">            If input is a str, then it can either be a multi-line string of</span>
<span class="sd">            the form ::</span>

<span class="sd">              &#39;&#39;&#39;</span>
<span class="sd">              AAE</span>
<span class="sd">              C.E</span>
<span class="sd">              &#39;&#39;&#39;</span>

<span class="sd">            where each character is a column and each line is a row. Or it</span>
<span class="sd">            can be a single-line string where rows are separated by ``;``::</span>

<span class="sd">              &#39;AB;CC&#39;</span>

<span class="sd">            The string notation allows only single character Axes labels and</span>
<span class="sd">            does not support nesting but is very terse.</span>

<span class="sd">            The Axes identifiers may be `str` or a non-iterable hashable</span>
<span class="sd">            object (e.g. `tuple` s may not be used).</span>

<span class="sd">        sharex, sharey : bool, default: False</span>
<span class="sd">            If True, the x-axis (*sharex*) or y-axis (*sharey*) will be shared</span>
<span class="sd">            among all subplots.  In that case, tick label visibility and axis</span>
<span class="sd">            units behave as for `subplots`.  If False, each subplot&#39;s x- or</span>
<span class="sd">            y-axis will be independent.</span>

<span class="sd">        width_ratios : array-like of length *ncols*, optional</span>
<span class="sd">            Defines the relative widths of the columns. Each column gets a</span>
<span class="sd">            relative width of ``width_ratios[i] / sum(width_ratios)``.</span>
<span class="sd">            If not given, all columns will have the same width.  Equivalent</span>
<span class="sd">            to ``gridspec_kw={&#39;width_ratios&#39;: [...]}``. In the case of nested</span>
<span class="sd">            layouts, this argument applies only to the outer layout.</span>

<span class="sd">        height_ratios : array-like of length *nrows*, optional</span>
<span class="sd">            Defines the relative heights of the rows. Each row gets a</span>
<span class="sd">            relative height of ``height_ratios[i] / sum(height_ratios)``.</span>
<span class="sd">            If not given, all rows will have the same height. Equivalent</span>
<span class="sd">            to ``gridspec_kw={&#39;height_ratios&#39;: [...]}``. In the case of nested</span>
<span class="sd">            layouts, this argument applies only to the outer layout.</span>

<span class="sd">        subplot_kw : dict, optional</span>
<span class="sd">            Dictionary with keywords passed to the `.Figure.add_subplot` call</span>
<span class="sd">            used to create each subplot.  These values may be overridden by</span>
<span class="sd">            values in *per_subplot_kw*.</span>

<span class="sd">        per_subplot_kw : dict, optional</span>
<span class="sd">            A dictionary mapping the Axes identifiers or tuples of identifiers</span>
<span class="sd">            to a dictionary of keyword arguments to be passed to the</span>
<span class="sd">            `.Figure.add_subplot` call used to create each subplot.  The values</span>
<span class="sd">            in these dictionaries have precedence over the values in</span>
<span class="sd">            *subplot_kw*.</span>

<span class="sd">            If *mosaic* is a string, and thus all keys are single characters,</span>
<span class="sd">            it is possible to use a single string instead of a tuple as keys;</span>
<span class="sd">            i.e. ``&quot;AB&quot;`` is equivalent to ``(&quot;A&quot;, &quot;B&quot;)``.</span>

<span class="sd">            .. versionadded:: 3.7</span>

<span class="sd">        gridspec_kw : dict, optional</span>
<span class="sd">            Dictionary with keywords passed to the `.GridSpec` constructor used</span>
<span class="sd">            to create the grid the subplots are placed on. In the case of</span>
<span class="sd">            nested layouts, this argument applies only to the outer layout.</span>
<span class="sd">            For more complex layouts, users should use `.Figure.subfigures`</span>
<span class="sd">            to create the nesting.</span>

<span class="sd">        empty_sentinel : object, optional</span>
<span class="sd">            Entry in the layout to mean &quot;leave this space empty&quot;.  Defaults</span>
<span class="sd">            to ``&#39;.&#39;``. Note, if *layout* is a string, it is processed via</span>
<span class="sd">            `inspect.cleandoc` to remove leading white space, which may</span>
<span class="sd">            interfere with using white-space as the empty sentinel.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict[label, Axes]</span>
<span class="sd">           A dictionary mapping the labels to the Axes objects.  The order of</span>
<span class="sd">           the Axes is left-to-right and top-to-bottom of their position in the</span>
<span class="sd">           total layout.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">subplot_kw</span> <span class="o">=</span> <span class="n">subplot_kw</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">gridspec_kw</span> <span class="ow">or</span> <span class="p">{})</span>
        <span class="n">per_subplot_kw</span> <span class="o">=</span> <span class="n">per_subplot_kw</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">height_ratios</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;height_ratios&#39;</span> <span class="ow">in</span> <span class="n">gridspec_kw</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;height_ratios&#39; must not be defined both as &quot;</span>
                                 <span class="s2">&quot;parameter and as key in &#39;gridspec_kw&#39;&quot;</span><span class="p">)</span>
            <span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;height_ratios&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">height_ratios</span>
        <span class="k">if</span> <span class="n">width_ratios</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;width_ratios&#39;</span> <span class="ow">in</span> <span class="n">gridspec_kw</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;width_ratios&#39; must not be defined both as &quot;</span>
                                 <span class="s2">&quot;parameter and as key in &#39;gridspec_kw&#39;&quot;</span><span class="p">)</span>
            <span class="n">gridspec_kw</span><span class="p">[</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">width_ratios</span>

        <span class="c1"># special-case string input</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mosaic</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">mosaic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalize_grid_string</span><span class="p">(</span><span class="n">mosaic</span><span class="p">)</span>
            <span class="n">per_subplot_kw</span> <span class="o">=</span> <span class="p">{</span>
                <span class="nb">tuple</span><span class="p">(</span><span class="n">k</span><span class="p">):</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">per_subplot_kw</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

        <span class="n">per_subplot_kw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_norm_per_subplot_kw</span><span class="p">(</span><span class="n">per_subplot_kw</span><span class="p">)</span>

        <span class="c1"># Only accept strict bools to allow a possible future API expansion.</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">check_isinstance</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">sharey</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_make_array</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Convert input into 2D array</span>

<span class="sd">            We need to have this internal function rather than</span>
<span class="sd">            ``np.asarray(..., dtype=object)`` so that a list of lists</span>
<span class="sd">            of lists does not get converted to an array of dimension &gt; 2.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            2D object array</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">r0</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="n">inp</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r0</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;List mosaic specification must be 2D&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;List mosaic specification must be 2D&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;All of the rows must be the same length, however &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;the first row (</span><span class="si">{</span><span class="n">r0</span><span class="si">!r}</span><span class="s2">) has length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">r0</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;and row </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">r</span><span class="si">!r}</span><span class="s2">) has length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
                    <span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">inp</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">r0</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inp</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
                    <span class="n">out</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">return</span> <span class="n">out</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_identify_keys_and_nested</span><span class="p">(</span><span class="n">mosaic</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Given a 2D object array, identify unique IDs and nested mosaics</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            mosaic : 2D object array</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            unique_ids : tuple</span>
<span class="sd">                The unique non-sub mosaic entries in this mosaic</span>
<span class="sd">            nested : dict[tuple[int, int], 2D object array]</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># make sure we preserve the user supplied order</span>
            <span class="n">unique_ids</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_OrderedSet</span><span class="p">()</span>
            <span class="n">nested</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mosaic</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">empty_sentinel</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">cbook</span><span class="o">.</span><span class="n">is_scalar_or_string</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
                        <span class="n">nested</span><span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">_make_array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">unique_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">unique_ids</span><span class="p">),</span> <span class="n">nested</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_do_layout</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">mosaic</span><span class="p">,</span> <span class="n">unique_ids</span><span class="p">,</span> <span class="n">nested</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Recursively do the mosaic.</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            gs : GridSpec</span>
<span class="sd">            mosaic : 2D object array</span>
<span class="sd">                The input converted to a 2D array for this level.</span>
<span class="sd">            unique_ids : tuple</span>
<span class="sd">                The identified scalar labels at this level of nesting.</span>
<span class="sd">            nested : dict[tuple[int, int]], 2D object array</span>
<span class="sd">                The identified nested mosaics, if any.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            dict[label, Axes]</span>
<span class="sd">                A flat dict of all of the Axes created.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">output</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="c1"># we need to merge together the Axes at this level and the Axes</span>
            <span class="c1"># in the (recursively) nested sub-mosaics so that we can add</span>
            <span class="c1"># them to the figure in the &quot;natural&quot; order if you were to</span>
            <span class="c1"># ravel in c-order all of the Axes that will be created</span>
            <span class="c1">#</span>
            <span class="c1"># This will stash the upper left index of each object (axes or</span>
            <span class="c1"># nested mosaic) at this level</span>
            <span class="n">this_level</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="c1"># go through the unique keys,</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">unique_ids</span><span class="p">:</span>
                <span class="c1"># sort out where each axes starts/ends</span>
                <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">mosaic</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">start_row</span><span class="p">,</span> <span class="n">start_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">indx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">end_row</span><span class="p">,</span> <span class="n">end_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">indx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="c1"># and construct the slice object</span>
                <span class="n">slc</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">start_row</span><span class="p">,</span> <span class="n">end_row</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start_col</span><span class="p">,</span> <span class="n">end_col</span><span class="p">))</span>
                <span class="c1"># some light error checking</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">mosaic</span><span class="p">[</span><span class="n">slc</span><span class="p">]</span> <span class="o">!=</span> <span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;While trying to layout</span><span class="se">\n</span><span class="si">{</span><span class="n">mosaic</span><span class="si">!r}</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;we found that the label </span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s2"> specifies a &quot;</span>
                        <span class="s2">&quot;non-rectangular or non-contiguous area.&quot;</span><span class="p">)</span>
                <span class="c1"># and stash this slice for later</span>
                <span class="n">this_level</span><span class="p">[(</span><span class="n">start_row</span><span class="p">,</span> <span class="n">start_col</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">slc</span><span class="p">,</span> <span class="s1">&#39;axes&#39;</span><span class="p">)</span>

            <span class="c1"># do the same thing for the nested mosaics (simpler because these</span>
            <span class="c1"># cannot be spans yet!)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">nested_mosaic</span> <span class="ow">in</span> <span class="n">nested</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">this_level</span><span class="p">[(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">nested_mosaic</span><span class="p">,</span> <span class="s1">&#39;nested&#39;</span><span class="p">)</span>

            <span class="c1"># now go through the things in this level and add them</span>
            <span class="c1"># in order left-to-right top-to-bottom</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">this_level</span><span class="p">):</span>
                <span class="n">name</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">this_level</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="c1"># we are doing some hokey function dispatch here based</span>
                <span class="c1"># on the &#39;method&#39; string stashed above to sort out if this</span>
                <span class="c1"># element is an Axes or a nested mosaic.</span>
                <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;axes&#39;</span><span class="p">:</span>
                    <span class="n">slc</span> <span class="o">=</span> <span class="n">arg</span>
                    <span class="c1"># add a single Axes</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There are duplicate keys </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
                                         <span class="sa">f</span><span class="s2">&quot;in the layout</span><span class="se">\n</span><span class="si">{</span><span class="n">mosaic</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span>
                        <span class="n">gs</span><span class="p">[</span><span class="n">slc</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span>
                            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
                            <span class="o">**</span><span class="n">subplot_kw</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">per_subplot_kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">{})</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
                    <span class="n">output</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
                <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;nested&#39;</span><span class="p">:</span>
                    <span class="n">nested_mosaic</span> <span class="o">=</span> <span class="n">arg</span>
                    <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">key</span>
                    <span class="c1"># recursively add the nested mosaic</span>
                    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">nested_mosaic</span><span class="o">.</span><span class="n">shape</span>
                    <span class="n">nested_output</span> <span class="o">=</span> <span class="n">_do_layout</span><span class="p">(</span>
                        <span class="n">gs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">subgridspec</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">),</span>
                        <span class="n">nested_mosaic</span><span class="p">,</span>
                        <span class="o">*</span><span class="n">_identify_keys_and_nested</span><span class="p">(</span><span class="n">nested_mosaic</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">overlap</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">nested_output</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">overlap</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;There are duplicate keys </span><span class="si">{</span><span class="n">overlap</span><span class="si">}</span><span class="s2"> &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;between the outer layout</span><span class="se">\n</span><span class="si">{</span><span class="n">mosaic</span><span class="si">!r}</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;and the nested layout</span><span class="se">\n</span><span class="si">{</span><span class="n">nested_mosaic</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="p">)</span>
                    <span class="n">output</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">nested_output</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This should never happen&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="n">mosaic</span> <span class="o">=</span> <span class="n">_make_array</span><span class="p">(</span><span class="n">mosaic</span><span class="p">)</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">mosaic</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="o">**</span><span class="n">gridspec_kw</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">_do_layout</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">mosaic</span><span class="p">,</span> <span class="o">*</span><span class="n">_identify_keys_and_nested</span><span class="p">(</span><span class="n">mosaic</span><span class="p">))</span>
        <span class="n">ax0</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ret</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ret</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">sharex</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">ax0</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">_label_outer_xaxis</span><span class="p">(</span><span class="n">skip_non_rectangular_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sharey</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">ax0</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">_label_outer_yaxis</span><span class="p">(</span><span class="n">skip_non_rectangular_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extra</span> <span class="o">:=</span> <span class="nb">set</span><span class="p">(</span><span class="n">per_subplot_kw</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">ret</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The keys </span><span class="si">{</span><span class="n">extra</span><span class="si">}</span><span class="s2"> are in *per_subplot_kw* &quot;</span>
                <span class="s2">&quot;but not in the mosaic.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_artist_props</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">a</span><span class="o">.</span><span class="n">set_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">a</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transSubfigure</span><span class="p">)</span>


<span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SubFigure</span><span class="p">(</span><span class="n">FigureBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Logical figure that can be placed inside a figure.</span>

<span class="sd">    See :ref:`figure-api-subfigure` for an index of methods on this class.</span>
<span class="sd">    Typically instantiated using `.Figure.add_subfigure` or</span>
<span class="sd">    `.SubFigure.add_subfigure`, or `.SubFigure.subfigures`.  A subfigure has</span>
<span class="sd">    the same methods as a figure except for those particularly tied to the size</span>
<span class="sd">    or dpi of the figure, and is confined to a prescribed region of the figure.</span>
<span class="sd">    For example the following puts two subfigures side-by-side::</span>

<span class="sd">        fig = plt.figure()</span>
<span class="sd">        sfigs = fig.subfigures(1, 2)</span>
<span class="sd">        axsL = sfigs[0].subplots(1, 2)</span>
<span class="sd">        axsR = sfigs[1].subplots(2, 1)</span>

<span class="sd">    See :doc:`/gallery/subplots_axes_and_figures/subfigures`</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">subplotspec</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">facecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">frameon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent : `.Figure` or `.SubFigure`</span>
<span class="sd">            Figure or subfigure that contains the SubFigure.  SubFigures</span>
<span class="sd">            can be nested.</span>

<span class="sd">        subplotspec : `.gridspec.SubplotSpec`</span>
<span class="sd">            Defines the region in a parent gridspec where the subfigure will</span>
<span class="sd">            be placed.</span>

<span class="sd">        facecolor : default: ``&quot;none&quot;``</span>
<span class="sd">            The figure patch face color; transparent by default.</span>

<span class="sd">        edgecolor : default: :rc:`figure.edgecolor`</span>
<span class="sd">            The figure patch edge color.</span>

<span class="sd">        linewidth : float</span>
<span class="sd">            The linewidth of the frame (i.e. the edge linewidth of the figure</span>
<span class="sd">            patch).</span>

<span class="sd">        frameon : bool, default: :rc:`figure.frameon`</span>
<span class="sd">            If ``False``, suppress drawing the figure background patch.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `.SubFigure` properties, optional</span>

<span class="sd">            %(SubFigure:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">facecolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">facecolor</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
        <span class="k">if</span> <span class="n">edgecolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.edgecolor&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">frameon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frameon</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.frameon&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_subplotspec</span> <span class="o">=</span> <span class="n">subplotspec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_root_figure</span>

        <span class="c1"># subfigures use the parent axstack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_axstack</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplotpars</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">subplotpars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">dpi_scale_trans</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">_axobservers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transFigure</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">transFigure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_relative</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">null</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redo_transform_rel_fig</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figbbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">figbbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">TransformedBbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_relative</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">transSubfigure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transSubfigure</span> <span class="o">=</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">frameon</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="c1"># Don&#39;t let the figure patch influence bbox calculation.</span>
            <span class="n">in_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transSubfigure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_artist_props</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_antialiased</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">canvas</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">dpi</span>

    <span class="nd">@dpi</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the resolution of the parent figure in dots-per-inch as a float.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">dpi</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the resolution of parent figure in dots-per-inch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_renderer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_get_renderer</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_redo_transform_rel_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make the transSubfigure bbox relative to Figure transform.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bbox : bbox or None</span>
<span class="sd">            If not None, then the bbox is used for relative bounding box.</span>
<span class="sd">            Otherwise, it is calculated from the subplotspec.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bbox_relative</span><span class="o">.</span><span class="n">p0</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bbox_relative</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">p1</span>
            <span class="k">return</span>
        <span class="c1"># need to figure out *where* this subplotspec is.</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subplotspec</span><span class="o">.</span><span class="n">get_gridspec</span><span class="p">()</span>
        <span class="n">wr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">get_width_ratios</span><span class="p">())</span>
        <span class="n">hr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">gs</span><span class="o">.</span><span class="n">get_height_ratios</span><span class="p">())</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">wr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_subplotspec</span><span class="o">.</span><span class="n">colspan</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">wr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">hr</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_subplotspec</span><span class="o">.</span><span class="n">rowspan</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">hr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="n">wr</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">_subplotspec</span><span class="o">.</span><span class="n">colspan</span><span class="o">.</span><span class="n">start</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">wr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">hr</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">_subplotspec</span><span class="o">.</span><span class="n">rowspan</span><span class="o">.</span><span class="n">stop</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">hr</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_relative</span><span class="o">.</span><span class="n">p0</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_relative</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_constrained_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether constrained layout is being used.</span>

<span class="sd">        See :ref:`constrainedlayout_guide`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">get_constrained_layout</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_constrained_layout_pads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get padding for ``constrained_layout``.</span>

<span class="sd">        Returns a list of ``w_pad, h_pad`` in inches and</span>
<span class="sd">        ``wspace`` and ``hspace`` as fractions of the subplot.</span>

<span class="sd">        See :ref:`constrainedlayout_guide`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        relative : bool</span>
<span class="sd">            If `True`, then convert from inches to figure relative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">get_constrained_layout_pads</span><span class="p">(</span><span class="n">relative</span><span class="o">=</span><span class="n">relative</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_layout_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of Axes in the SubFigure.  You can access and modify the Axes</span>
<span class="sd">        in the SubFigure through this list.</span>

<span class="sd">        Modifying this list has no effect. Instead, use `~.SubFigure.add_axes`,</span>
<span class="sd">        `~.SubFigure.add_subplot` or `~.SubFigure.delaxes` to add or remove an</span>
<span class="sd">        Axes.</span>

<span class="sd">        Note: The `.SubFigure.axes` property and `~.SubFigure.get_axes` method</span>
<span class="sd">        are equivalent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_localaxes</span><span class="p">[:]</span>

    <span class="n">get_axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">fget</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>

        <span class="c1"># draw the figure bounding box, perhaps none for white figure</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="n">artists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_draw_artists</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">renderer</span><span class="o">.</span><span class="n">open_group</span><span class="p">(</span><span class="s1">&#39;subfigure&#39;</span><span class="p">,</span> <span class="n">gid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_gid</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
                <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>
            <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;subfigure&#39;</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="Figure">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure">[docs]</a>
<span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Figure</span><span class="p">(</span><span class="n">FigureBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The top level container for all the plot elements.</span>

<span class="sd">    See `matplotlib.figure` for an index of class methods.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    patch</span>
<span class="sd">        The `.Rectangle` instance representing the figure background patch.</span>

<span class="sd">    suppressComposite</span>
<span class="sd">        For multiple images, the figure will make composite images</span>
<span class="sd">        depending on the renderer option_image_nocomposite function.  If</span>
<span class="sd">        *suppressComposite* is a boolean, this will override the renderer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># we want to cache the fonts and mathtext at a global level so that when</span>
    <span class="c1"># multiple figures are created we can reuse them.  This helps with a bug on</span>
    <span class="c1"># windows where the creation of too many figures leads to too many open</span>
    <span class="c1"># file handles and improves the performance of parsing mathtext.  However,</span>
    <span class="c1"># these global caches are not thread safe.  The solution here is to let the</span>
    <span class="c1"># Figure acquire a shared lock at the start of the draw, and release it when it</span>
    <span class="c1"># is done.  This allows multiple renderers to share the cached fonts and</span>
    <span class="c1"># parsed text, but only one figure can draw at a time and so the font cache</span>
    <span class="c1"># and mathtext cache are used by only one renderer at a time.</span>

    <span class="n">_render_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Figure(</span><span class="si">%g</span><span class="s2">x</span><span class="si">%g</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&lt;</span><span class="si">{clsname}</span><span class="s2"> size </span><span class="si">{h:g}</span><span class="s2">x</span><span class="si">{w:g}</span><span class="s2"> with </span><span class="si">{naxes}</span><span class="s2"> Axes&gt;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">clsname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">h</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">naxes</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">),</span>
        <span class="p">)</span>

<div class="viewcode-block" id="Figure.__init__">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">*</span><span class="p">,</span>
                 <span class="n">facecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="n">frameon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">subplotpars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># rc figure.subplot.*</span>
                 <span class="n">tight_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># rc figure.autolayout</span>
                 <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># rc figure.constrained_layout.use</span>
                 <span class="n">layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span>
                 <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figsize : 2-tuple of floats, default: :rc:`figure.figsize`</span>
<span class="sd">            Figure dimension ``(width, height)`` in inches.</span>

<span class="sd">        dpi : float, default: :rc:`figure.dpi`</span>
<span class="sd">            Dots per inch.</span>

<span class="sd">        facecolor : default: :rc:`figure.facecolor`</span>
<span class="sd">            The figure patch facecolor.</span>

<span class="sd">        edgecolor : default: :rc:`figure.edgecolor`</span>
<span class="sd">            The figure patch edge color.</span>

<span class="sd">        linewidth : float</span>
<span class="sd">            The linewidth of the frame (i.e. the edge linewidth of the figure</span>
<span class="sd">            patch).</span>

<span class="sd">        frameon : bool, default: :rc:`figure.frameon`</span>
<span class="sd">            If ``False``, suppress drawing the figure background patch.</span>

<span class="sd">        subplotpars : `~matplotlib.gridspec.SubplotParams`</span>
<span class="sd">            Subplot parameters. If not given, the default subplot</span>
<span class="sd">            parameters :rc:`figure.subplot.*` are used.</span>

<span class="sd">        tight_layout : bool or dict, default: :rc:`figure.autolayout`</span>
<span class="sd">            Whether to use the tight layout mechanism. See `.set_tight_layout`.</span>

<span class="sd">            .. admonition:: Discouraged</span>

<span class="sd">                The use of this parameter is discouraged. Please use</span>
<span class="sd">                ``layout=&#39;tight&#39;`` instead for the common case of</span>
<span class="sd">                ``tight_layout=True`` and use `.set_tight_layout` otherwise.</span>

<span class="sd">        constrained_layout : bool, default: :rc:`figure.constrained_layout.use`</span>
<span class="sd">            This is equal to ``layout=&#39;constrained&#39;``.</span>

<span class="sd">            .. admonition:: Discouraged</span>

<span class="sd">                The use of this parameter is discouraged. Please use</span>
<span class="sd">                ``layout=&#39;constrained&#39;`` instead.</span>

<span class="sd">        layout : {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, `.LayoutEngine`, \</span>
<span class="sd">None}, default: None</span>
<span class="sd">            The layout mechanism for positioning of plot elements to avoid</span>
<span class="sd">            overlapping Axes decorations (labels, ticks, etc). Note that</span>
<span class="sd">            layout managers can have significant performance penalties.</span>

<span class="sd">            - &#39;constrained&#39;: The constrained layout solver adjusts Axes sizes</span>
<span class="sd">              to avoid overlapping Axes decorations.  Can handle complex plot</span>
<span class="sd">              layouts and colorbars, and is thus recommended.</span>

<span class="sd">              See :ref:`constrainedlayout_guide` for examples.</span>

<span class="sd">            - &#39;compressed&#39;: uses the same algorithm as &#39;constrained&#39;, but</span>
<span class="sd">              removes extra space between fixed-aspect-ratio Axes.  Best for</span>
<span class="sd">              simple grids of Axes.</span>

<span class="sd">            - &#39;tight&#39;: Use the tight layout mechanism. This is a relatively</span>
<span class="sd">              simple algorithm that adjusts the subplot parameters so that</span>
<span class="sd">              decorations do not overlap.</span>

<span class="sd">              See :ref:`tight_layout_guide` for examples.</span>

<span class="sd">            - &#39;none&#39;: Do not use a layout engine.</span>

<span class="sd">            - A `.LayoutEngine` instance. Builtin layout classes are</span>
<span class="sd">              `.ConstrainedLayoutEngine` and `.TightLayoutEngine`, more easily</span>
<span class="sd">              accessible by &#39;constrained&#39; and &#39;tight&#39;.  Passing an instance</span>
<span class="sd">              allows third parties to provide their own layout engine.</span>

<span class="sd">            If not given, fall back to using the parameters *tight_layout* and</span>
<span class="sd">            *constrained_layout*, including their config defaults</span>
<span class="sd">            :rc:`figure.autolayout` and :rc:`figure.constrained_layout.use`.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `.Figure` properties, optional</span>

<span class="sd">            %(Figure:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root_figure</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">tight_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                    <span class="s2">&quot;The Figure parameters &#39;layout&#39; and &#39;tight_layout&#39; cannot &quot;</span>
                    <span class="s2">&quot;be used together. Please use &#39;layout&#39; only.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">constrained_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                    <span class="s2">&quot;The Figure parameters &#39;layout&#39; and &#39;constrained_layout&#39; &quot;</span>
                    <span class="s2">&quot;cannot be used together. Please use &#39;layout&#39; only.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tight_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">constrained_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                    <span class="s2">&quot;The Figure parameters &#39;tight_layout&#39; and &quot;</span>
                    <span class="s2">&quot;&#39;constrained_layout&#39; cannot be used together. Please use &quot;</span>
                    <span class="s2">&quot;&#39;layout&#39; parameter&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tight_layout</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">tight_layout</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">constrained_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constrained_layout</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">constrained_layout</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">constrained_layout</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># everything is None, so use default:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

        <span class="c1"># Callbacks traditionally associated with the canvas (and exposed with</span>
        <span class="c1"># a proxy property), but that actually need to be on the figure for</span>
        <span class="c1"># pickling.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_canvas_callbacks</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">CallbackRegistry</span><span class="p">(</span>
            <span class="n">signals</span><span class="o">=</span><span class="n">FigureCanvasBase</span><span class="o">.</span><span class="n">events</span><span class="p">)</span>
        <span class="n">connect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_canvas_callbacks</span><span class="o">.</span><span class="n">_connect_picklable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mouse_key_ids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;key_press_event&#39;</span><span class="p">,</span> <span class="n">backend_bases</span><span class="o">.</span><span class="n">_key_handler</span><span class="p">),</span>
            <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;key_release_event&#39;</span><span class="p">,</span> <span class="n">backend_bases</span><span class="o">.</span><span class="n">_key_handler</span><span class="p">),</span>
            <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;key_release_event&#39;</span><span class="p">,</span> <span class="n">backend_bases</span><span class="o">.</span><span class="n">_key_handler</span><span class="p">),</span>
            <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="n">backend_bases</span><span class="o">.</span><span class="n">_mouse_handler</span><span class="p">),</span>
            <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;button_release_event&#39;</span><span class="p">,</span> <span class="n">backend_bases</span><span class="o">.</span><span class="n">_mouse_handler</span><span class="p">),</span>
            <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;scroll_event&#39;</span><span class="p">,</span> <span class="n">backend_bases</span><span class="o">.</span><span class="n">_mouse_handler</span><span class="p">),</span>
            <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;motion_notify_event&#39;</span><span class="p">,</span> <span class="n">backend_bases</span><span class="o">.</span><span class="n">_mouse_handler</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_button_pick_id</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scroll_pick_id</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="s1">&#39;scroll_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pick</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">figsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dpi</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dpi</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">facecolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">facecolor</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">edgecolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.edgecolor&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">frameon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frameon</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.frameon&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">figsize</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">figsize</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;figure size must be positive finite not &#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">figsize</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">figsize</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpi</span><span class="p">)</span>
        <span class="c1"># do not use property as it will trigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span> <span class="o">=</span> <span class="n">dpi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span> <span class="o">=</span> <span class="n">TransformedBbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figbbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transFigure</span> <span class="o">=</span> <span class="n">BboxTransformTo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transSubfigure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transFigure</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">frameon</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="c1"># Don&#39;t let the figure patch influence bbox calculation.</span>
            <span class="n">in_layout</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_artist_props</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_antialiased</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">FigureCanvasBase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Set self.canvas.</span>

        <span class="k">if</span> <span class="n">subplotpars</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subplotpars</span> <span class="o">=</span> <span class="n">SubplotParams</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">subplotpars</span> <span class="o">=</span> <span class="n">subplotpars</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span> <span class="o">=</span> <span class="n">_AxesStack</span><span class="p">()</span>  <span class="c1"># track all figure Axes and current Axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


<div class="viewcode-block" id="Figure.pick">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.pick">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">widgetlock</span><span class="o">.</span><span class="n">locked</span><span class="p">():</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">pick</span><span class="p">(</span><span class="n">mouseevent</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_check_layout_engines_compat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper for set_layout engine</span>

<span class="sd">        If the figure has used the old engine and added a colorbar then the</span>
<span class="sd">        value of colorbar_gridspec must be the same on the new engine.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">old</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">new</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">old</span><span class="o">.</span><span class="n">colorbar_gridspec</span> <span class="o">==</span> <span class="n">new</span><span class="o">.</span><span class="n">colorbar_gridspec</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># colorbar layout different, so check if any colorbars are on the</span>
        <span class="c1"># figure...</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;_colorbar&#39;</span><span class="p">):</span>
                <span class="c1"># colorbars list themselves as a colorbar.</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="Figure.set_layout_engine">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_layout_engine">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_layout_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the layout engine for this figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        layout : {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, `.LayoutEngine`, None}</span>

<span class="sd">            - &#39;constrained&#39; will use `~.ConstrainedLayoutEngine`</span>
<span class="sd">            - &#39;compressed&#39; will also use `~.ConstrainedLayoutEngine`, but with</span>
<span class="sd">              a correction that attempts to make a good layout for fixed-aspect</span>
<span class="sd">              ratio Axes.</span>
<span class="sd">            - &#39;tight&#39; uses `~.TightLayoutEngine`</span>
<span class="sd">            - &#39;none&#39; removes layout engine.</span>

<span class="sd">            If a `.LayoutEngine` instance, that instance will be used.</span>

<span class="sd">            If `None`, the behavior is controlled by :rc:`figure.autolayout`</span>
<span class="sd">            (which if `True` behaves as if &#39;tight&#39; was passed) and</span>
<span class="sd">            :rc:`figure.constrained_layout.use` (which if `True` behaves as if</span>
<span class="sd">            &#39;constrained&#39; was passed).  If both are `True`,</span>
<span class="sd">            :rc:`figure.autolayout` takes priority.</span>

<span class="sd">            Users and libraries can define their own layout engines and pass</span>
<span class="sd">            the instance directly as well.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            The keyword arguments are passed to the layout engine to set things</span>
<span class="sd">            like padding and margin sizes.  Only used if *layout* is a string.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">layout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.autolayout&#39;</span><span class="p">]:</span>
                <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span>
            <span class="k">elif</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">]:</span>
                <span class="n">layout</span> <span class="o">=</span> <span class="s1">&#39;constrained&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="n">layout</span> <span class="o">==</span> <span class="s1">&#39;tight&#39;</span><span class="p">:</span>
            <span class="n">new_layout_engine</span> <span class="o">=</span> <span class="n">TightLayoutEngine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">layout</span> <span class="o">==</span> <span class="s1">&#39;constrained&#39;</span><span class="p">:</span>
            <span class="n">new_layout_engine</span> <span class="o">=</span> <span class="n">ConstrainedLayoutEngine</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">layout</span> <span class="o">==</span> <span class="s1">&#39;compressed&#39;</span><span class="p">:</span>
            <span class="n">new_layout_engine</span> <span class="o">=</span> <span class="n">ConstrainedLayoutEngine</span><span class="p">(</span><span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">layout</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_layout_engine</span> <span class="o">=</span> <span class="n">PlaceHolderLayoutEngine</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span><span class="o">.</span><span class="n">adjust_compatible</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span><span class="o">.</span><span class="n">colorbar_gridspec</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_layout_engine</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">LayoutEngine</span><span class="p">):</span>
            <span class="n">new_layout_engine</span> <span class="o">=</span> <span class="n">layout</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid value for &#39;layout&#39;: </span><span class="si">{</span><span class="n">layout</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_layout_engines_compat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span><span class="p">,</span>
                                             <span class="n">new_layout_engine</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span> <span class="o">=</span> <span class="n">new_layout_engine</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Colorbar layout of new layout engine not &#39;</span>
                               <span class="s1">&#39;compatible with old engine, and a colorbar &#39;</span>
                               <span class="s1">&#39;has been created.  Engine not changed.&#39;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_layout_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout_engine</span>

    <span class="c1"># TODO: I&#39;d like to dynamically add the _repr_html_ method</span>
    <span class="c1"># to the figure in the right context, but then IPython doesn&#39;t</span>
    <span class="c1"># use it, for some reason.</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># We can&#39;t use &quot;isinstance&quot; here, because then we&#39;d end up importing</span>
        <span class="c1"># webagg unconditionally.</span>
        <span class="k">if</span> <span class="s1">&#39;WebAgg&#39;</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">backend_webagg</span>
            <span class="k">return</span> <span class="n">backend_webagg</span><span class="o">.</span><span class="n">ipython_inline_display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Figure.show">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.show">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">warn</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If using a GUI backend with pyplot, display the figure window.</span>

<span class="sd">        If the figure was not created using `~.pyplot.figure`, it will lack</span>
<span class="sd">        a `~.backend_bases.FigureManagerBase`, and this method will raise an</span>
<span class="sd">        AttributeError.</span>

<span class="sd">        .. warning::</span>

<span class="sd">            This does not manage an GUI event loop. Consequently, the figure</span>
<span class="sd">            may only be shown briefly or not shown at all if you or your</span>
<span class="sd">            environment are not managing an event loop.</span>

<span class="sd">            Use cases for `.Figure.show` include running this from a GUI</span>
<span class="sd">            application (where there is persistently an event loop running) or</span>
<span class="sd">            from a shell, like IPython, that install an input hook to allow the</span>
<span class="sd">            interactive shell to accept input while the figure is also being</span>
<span class="sd">            shown and interactive.  Some, but not all, GUI toolkits will</span>
<span class="sd">            register an input hook on import.  See :ref:`cp_integration` for</span>
<span class="sd">            more details.</span>

<span class="sd">            If you&#39;re in a shell without input hook integration or executing a</span>
<span class="sd">            python script, you should use `matplotlib.pyplot.show` with</span>
<span class="sd">            ``block=True`` instead, which takes care of starting and running</span>
<span class="sd">            the event loop for you.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        warn : bool, default: True</span>
<span class="sd">            If ``True`` and we are not running headless (i.e. on Linux with an</span>
<span class="sd">            unset DISPLAY), issue warning when called on a non-GUI backend.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;Figure.show works only for figures managed by pyplot, &quot;</span>
                <span class="s2">&quot;normally created by pyplot.figure()&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NonGuiException</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">warn</span><span class="p">:</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">))</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List of Axes in the Figure. You can access and modify the Axes in the</span>
<span class="sd">        Figure through this list.</span>

<span class="sd">        Do not modify the list itself. Instead, use `~Figure.add_axes`,</span>
<span class="sd">        `~.Figure.add_subplot` or `~.Figure.delaxes` to add or remove an Axes.</span>

<span class="sd">        Note: The `.Figure.axes` property and `~.Figure.get_axes` method are</span>
<span class="sd">        equivalent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axstack</span><span class="o">.</span><span class="n">as_list</span><span class="p">()</span>

    <span class="n">get_axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">fget</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The figure id, used to identify figures in `.pyplot`.&quot;&quot;&quot;</span>
        <span class="c1"># Historically, pyplot dynamically added a number attribute to figure.</span>
        <span class="c1"># However, this number must stay in sync with the figure manager.</span>
        <span class="c1"># AFAICS overwriting the number attribute does not have the desired</span>
        <span class="c1"># effect for pyplot. But there are some repos in GitHub that do change</span>
        <span class="c1"># number. So let&#39;s take it slow and properly migrate away from writing.</span>
        <span class="c1">#</span>
        <span class="c1"># Making the dynamic attribute private and wrapping it in a property</span>
        <span class="c1"># allows to maintain current behavior and deprecate write-access.</span>
        <span class="c1">#</span>
        <span class="c1"># When the deprecation expires, there&#39;s no need for duplicate state</span>
        <span class="c1"># anymore and the private _number attribute can be replaced by</span>
        <span class="c1"># `self.canvas.manager.num` if that exists and None otherwise.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_number&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_number</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;&#39;Figure&#39; object has no attribute &#39;number&#39;. In the future this&quot;</span>
                <span class="s2">&quot;will change to returning &#39;None&#39; instead.&quot;</span><span class="p">)</span>

    <span class="nd">@number</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="n">_api</span><span class="o">.</span><span class="n">warn_deprecated</span><span class="p">(</span>
            <span class="s2">&quot;3.10&quot;</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Changing &#39;Figure.number&#39; is deprecated since </span><span class="si">%(since)s</span><span class="s2"> and &quot;</span>
                    <span class="s2">&quot;will raise an error starting </span><span class="si">%(removal)s</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_number</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_renderer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s1">&#39;get_renderer&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_renderer</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_get_renderer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dpi</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dpi : float</span>

<span class="sd">        forward : bool</span>
<span class="sd">            Passed on to `~.Figure.set_size_inches`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dpi</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span><span class="p">:</span>
            <span class="c1"># We don&#39;t want to cause undue events in backends.</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dpi</span> <span class="o">=</span> <span class="n">dpi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">dpi</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span>

    <span class="n">dpi</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dpi</span><span class="p">,</span> <span class="n">_set_dpi</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">&quot;The resolution in dots per inch.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Figure.get_tight_layout">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.get_tight_layout">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_tight_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether `.Figure.tight_layout` is called when drawing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">(),</span> <span class="n">TightLayoutEngine</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.set_tight_layout">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_tight_layout">[docs]</a>
    <span class="nd">@_api</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.6&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;set_layout_engine&quot;</span><span class="p">,</span>
                     <span class="n">pending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_tight_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tight</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether and how `.Figure.tight_layout` is called when drawing.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tight : bool or dict with keys &quot;pad&quot;, &quot;w_pad&quot;, &quot;h_pad&quot;, &quot;rect&quot; or None</span>
<span class="sd">            If a bool, sets whether to call `.Figure.tight_layout` upon drawing.</span>
<span class="sd">            If ``None``, use :rc:`figure.autolayout` instead.</span>
<span class="sd">            If a dict, pass it as kwargs to `.Figure.tight_layout`, overriding the</span>
<span class="sd">            default paddings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tight</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tight</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.autolayout&#39;</span><span class="p">]</span>
        <span class="n">_tight</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">tight</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">_tight_parameters</span> <span class="o">=</span> <span class="n">tight</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tight</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">_tight</span><span class="p">,</span> <span class="o">**</span><span class="n">_tight_parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Figure.get_constrained_layout">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.get_constrained_layout">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_constrained_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether constrained layout is being used.</span>

<span class="sd">        See :ref:`constrainedlayout_guide`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">(),</span> <span class="n">ConstrainedLayoutEngine</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.set_constrained_layout">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_constrained_layout">[docs]</a>
    <span class="nd">@_api</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.6&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;set_layout_engine(&#39;constrained&#39;)&quot;</span><span class="p">,</span>
                     <span class="n">pending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_constrained_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constrained</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether ``constrained_layout`` is used upon drawing.</span>

<span class="sd">        If None, :rc:`figure.constrained_layout.use` value will be used.</span>

<span class="sd">        When providing a dict containing the keys ``w_pad``, ``h_pad``</span>
<span class="sd">        the default ``constrained_layout`` paddings will be</span>
<span class="sd">        overridden.  These pads are in inches and default to 3.0/72.0.</span>
<span class="sd">        ``w_pad`` is the width padding and ``h_pad`` is the height padding.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        constrained : bool or dict or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">constrained</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">constrained</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">]</span>
        <span class="n">_constrained</span> <span class="o">=</span> <span class="s1">&#39;constrained&#39;</span> <span class="k">if</span> <span class="nb">bool</span><span class="p">(</span><span class="n">constrained</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;none&#39;</span>
        <span class="n">_parameters</span> <span class="o">=</span> <span class="n">constrained</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constrained</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">_constrained</span><span class="p">,</span> <span class="o">**</span><span class="n">_parameters</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Figure.set_constrained_layout_pads">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_constrained_layout_pads">[docs]</a>
    <span class="nd">@_api</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span>
         <span class="s2">&quot;3.6&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;figure.get_layout_engine().set()&quot;</span><span class="p">,</span>
         <span class="n">pending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_constrained_layout_pads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set padding for ``constrained_layout``.</span>

<span class="sd">        Tip: The parameters can be passed from a dictionary by using</span>
<span class="sd">        ``fig.set_constrained_layout(**pad_dict)``.</span>

<span class="sd">        See :ref:`constrainedlayout_guide`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        w_pad : float, default: :rc:`figure.constrained_layout.w_pad`</span>
<span class="sd">            Width padding in inches.  This is the pad around Axes</span>
<span class="sd">            and is meant to make sure there is enough room for fonts to</span>
<span class="sd">            look good.  Defaults to 3 pts = 0.04167 inches</span>

<span class="sd">        h_pad : float, default: :rc:`figure.constrained_layout.h_pad`</span>
<span class="sd">            Height padding in inches. Defaults to 3 pts.</span>

<span class="sd">        wspace : float, default: :rc:`figure.constrained_layout.wspace`</span>
<span class="sd">            Width padding between subplots, expressed as a fraction of the</span>
<span class="sd">            subplot width.  The total padding ends up being w_pad + wspace.</span>

<span class="sd">        hspace : float, default: :rc:`figure.constrained_layout.hspace`</span>
<span class="sd">            Height padding between subplots, expressed as a fraction of the</span>
<span class="sd">            subplot width. The total padding ends up being h_pad + hspace.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">(),</span> <span class="n">ConstrainedLayoutEngine</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.get_constrained_layout_pads">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.get_constrained_layout_pads">[docs]</a>
    <span class="nd">@_api</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span><span class="s2">&quot;3.6&quot;</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;fig.get_layout_engine().get()&quot;</span><span class="p">,</span>
                     <span class="n">pending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_constrained_layout_pads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get padding for ``constrained_layout``.</span>

<span class="sd">        Returns a list of ``w_pad, h_pad`` in inches and</span>
<span class="sd">        ``wspace`` and ``hspace`` as fractions of the subplot.</span>
<span class="sd">        All values are None if ``constrained_layout`` is not used.</span>

<span class="sd">        See :ref:`constrainedlayout_guide`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        relative : bool</span>
<span class="sd">            If `True`, then convert from inches to figure relative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">(),</span> <span class="n">ConstrainedLayoutEngine</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">w_pad</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;w_pad&#39;</span><span class="p">]</span>
        <span class="n">h_pad</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;h_pad&#39;</span><span class="p">]</span>
        <span class="n">wspace</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;wspace&#39;</span><span class="p">]</span>
        <span class="n">hspace</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;hspace&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">relative</span> <span class="ow">and</span> <span class="p">(</span><span class="n">w_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">h_pad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_renderer</span><span class="p">()</span>
            <span class="n">dpi</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">dpi</span>
            <span class="n">w_pad</span> <span class="o">=</span> <span class="n">w_pad</span> <span class="o">*</span> <span class="n">dpi</span> <span class="o">/</span> <span class="n">renderer</span><span class="o">.</span><span class="n">width</span>
            <span class="n">h_pad</span> <span class="o">=</span> <span class="n">h_pad</span> <span class="o">*</span> <span class="n">dpi</span> <span class="o">/</span> <span class="n">renderer</span><span class="o">.</span><span class="n">height</span>

        <span class="k">return</span> <span class="n">w_pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="p">,</span> <span class="n">wspace</span><span class="p">,</span> <span class="n">hspace</span></div>


<div class="viewcode-block" id="Figure.set_canvas">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_canvas">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_canvas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the canvas that contains the figure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        canvas : FigureCanvas</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">canvas</span></div>


<div class="viewcode-block" id="Figure.figimage">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.figimage">[docs]</a>
    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">figimage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">xo</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">yo</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">colorizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a non-resampled image to the figure.</span>

<span class="sd">        The image is attached to the lower or upper left corner depending on</span>
<span class="sd">        *origin*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X</span>
<span class="sd">            The image data. This is an array of one of the following shapes:</span>

<span class="sd">            - (M, N): an image with scalar data.  Color-mapping is controlled</span>
<span class="sd">              by *cmap*, *norm*, *vmin*, and *vmax*.</span>
<span class="sd">            - (M, N, 3): an image with RGB values (0-1 float or 0-255 int).</span>
<span class="sd">            - (M, N, 4): an image with RGBA values (0-1 float or 0-255 int),</span>
<span class="sd">              i.e. including transparency.</span>

<span class="sd">        xo, yo : int</span>
<span class="sd">            The *x*/*y* image offset in pixels.</span>

<span class="sd">        alpha : None or float</span>
<span class="sd">            The alpha blending value.</span>

<span class="sd">        %(cmap_doc)s</span>

<span class="sd">            This parameter is ignored if *X* is RGB(A).</span>

<span class="sd">        %(norm_doc)s</span>

<span class="sd">            This parameter is ignored if *X* is RGB(A).</span>

<span class="sd">        %(vmin_vmax_doc)s</span>

<span class="sd">            This parameter is ignored if *X* is RGB(A).</span>

<span class="sd">        origin : {&#39;upper&#39;, &#39;lower&#39;}, default: :rc:`image.origin`</span>
<span class="sd">            Indicates where the [0, 0] index of the array is in the upper left</span>
<span class="sd">            or lower left corner of the Axes.</span>

<span class="sd">        resize : bool</span>
<span class="sd">            If *True*, resize the figure to match the given image size.</span>

<span class="sd">        %(colorizer_doc)s</span>

<span class="sd">            This parameter is ignored if *X* is RGB(A).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        `matplotlib.image.FigureImage`</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional kwargs are `.Artist` kwargs passed on to `.FigureImage`.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        figimage complements the Axes image (`~matplotlib.axes.Axes.imshow`)</span>
<span class="sd">        which will be resampled to fit the current Axes.  If you want</span>
<span class="sd">        a resampled image to fill the entire figure, you can define an</span>
<span class="sd">        `~matplotlib.axes.Axes` with extent [0, 0, 1, 1].</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            f = plt.figure()</span>
<span class="sd">            nx = int(f.get_figwidth() * f.dpi)</span>
<span class="sd">            ny = int(f.get_figheight() * f.dpi)</span>
<span class="sd">            data = np.random.random((ny, nx))</span>
<span class="sd">            f.figimage(data)</span>
<span class="sd">            plt.show()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">resize</span><span class="p">:</span>
            <span class="n">dpi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_dpi</span><span class="p">()</span>
            <span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">/</span> <span class="n">dpi</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">figsize</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">im</span> <span class="o">=</span> <span class="n">mimage</span><span class="o">.</span><span class="n">FigureImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
                                <span class="n">colorizer</span><span class="o">=</span><span class="n">colorizer</span><span class="p">,</span>
                                <span class="n">offsetx</span><span class="o">=</span><span class="n">xo</span><span class="p">,</span> <span class="n">offsety</span><span class="o">=</span><span class="n">yo</span><span class="p">,</span>
                                <span class="n">origin</span><span class="o">=</span><span class="n">origin</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">stale_callback</span> <span class="o">=</span> <span class="n">_stale_figure_callback</span>

        <span class="n">im</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span><span class="o">.</span><span class="n">_check_exclusionary_keywords</span><span class="p">(</span><span class="n">colorizer</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
            <span class="n">im</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">_remove_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">remove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">im</span></div>


<div class="viewcode-block" id="Figure.set_size_inches">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_size_inches">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the figure size in inches.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">             fig.set_size_inches(w, h)  # OR</span>
<span class="sd">             fig.set_size_inches((w, h))</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        w : (float, float) or float</span>
<span class="sd">            Width and height in inches (if height not specified as a separate</span>
<span class="sd">            argument) or width.</span>
<span class="sd">        h : float</span>
<span class="sd">            Height in inches.</span>
<span class="sd">        forward : bool, default: True</span>
<span class="sd">            If ``True``, the canvas size is automatically updated, e.g.,</span>
<span class="sd">            you can resize the figure window from the shell.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.get_size_inches</span>
<span class="sd">        matplotlib.figure.Figure.set_figwidth</span>
<span class="sd">        matplotlib.figure.Figure.set_figheight</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        To transform from pixels to inches divide by `Figure.dpi`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">h</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Got called with a single pair as argument.</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">w</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="ow">or</span> <span class="p">(</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;figure size must be positive finite not </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">p1</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">if</span> <span class="n">forward</span><span class="p">:</span>
            <span class="n">manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span>
            <span class="k">if</span> <span class="n">manager</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">manager</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Figure.get_size_inches">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.get_size_inches">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the current size of the figure in inches.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray</span>
<span class="sd">           The size (width, height) of the figure in inches.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.set_size_inches</span>
<span class="sd">        matplotlib.figure.Figure.get_figwidth</span>
<span class="sd">        matplotlib.figure.Figure.get_figheight</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The size in pixels can be obtained by multiplying with `Figure.dpi`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">p1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.get_figwidth">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.get_figwidth">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_figwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the figure width in inches.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">width</span></div>


<div class="viewcode-block" id="Figure.get_figheight">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.get_figheight">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_figheight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the figure height in inches.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox_inches</span><span class="o">.</span><span class="n">height</span></div>


<div class="viewcode-block" id="Figure.get_dpi">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.get_dpi">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the resolution in dots per inch as a float.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span></div>


<div class="viewcode-block" id="Figure.set_dpi">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_dpi">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_dpi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the resolution of the figure in dots-per-inch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dpi</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Figure.set_figwidth">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_figwidth">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_figwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the width of the figure in inches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">        forward : bool</span>
<span class="sd">            See `set_size_inches`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.set_figheight</span>
<span class="sd">        matplotlib.figure.Figure.set_size_inches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figheight</span><span class="p">(),</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.set_figheight">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.set_figheight">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_figheight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the height of the figure in inches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        val : float</span>
<span class="sd">        forward : bool</span>
<span class="sd">            See `set_size_inches`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.figure.Figure.set_figwidth</span>
<span class="sd">        matplotlib.figure.Figure.set_size_inches</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_figwidth</span><span class="p">(),</span> <span class="n">val</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.clear">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.clear">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_observers</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">keep_observers</span><span class="o">=</span><span class="n">keep_observers</span><span class="p">)</span>
        <span class="c1"># FigureBase.clear does not clear toolbars, as</span>
        <span class="c1"># only Figure can have toolbars</span>
        <span class="n">toolbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">toolbar</span>
        <span class="k">if</span> <span class="n">toolbar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">toolbar</span><span class="o">.</span><span class="n">update</span><span class="p">()</span></div>


<div class="viewcode-block" id="Figure.draw">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.draw">[docs]</a>
    <span class="nd">@_finalize_rasterization</span>
    <span class="nd">@allow_rasterization</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_render_lock</span><span class="p">:</span>

            <span class="n">artists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_draw_artists</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">renderer</span><span class="o">.</span><span class="n">open_group</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">gid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_gid</span><span class="p">())</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>
                        <span class="c1"># ValueError can occur when resizing a window.</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
                <span class="n">mimage</span><span class="o">.</span><span class="n">_draw_list_compositing_images</span><span class="p">(</span>
                    <span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">artists</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suppressComposite</span><span class="p">)</span>

                <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">)</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="n">DrawEvent</span><span class="p">(</span><span class="s2">&quot;draw_event&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span><span class="o">.</span><span class="n">_process</span><span class="p">()</span></div>


<div class="viewcode-block" id="Figure.draw_without_rendering">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.draw_without_rendering">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">draw_without_rendering</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the figure with no output.  Useful to get the final size of</span>
<span class="sd">        artists that require a draw before their size is known (e.g. text).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">renderer</span> <span class="o">=</span> <span class="n">_get_renderer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">renderer</span><span class="o">.</span><span class="n">_draw_disabled</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.draw_artist">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.draw_artist">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw `.Artist` *a* only.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_renderer</span><span class="p">())</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">()</span>

        <span class="c1"># The canvas cannot currently be pickled, but this has the benefit</span>
        <span class="c1"># of meaning that a figure can be detached from one canvas, and</span>
        <span class="c1"># re-attached to another.</span>
        <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">)</span>

        <span class="c1"># discard any changes to the dpi due to pixel ratio changes</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;_dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_original_dpi&#39;</span><span class="p">,</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_dpi&#39;</span><span class="p">])</span>

        <span class="c1"># add version information to the state</span>
        <span class="n">state</span><span class="p">[</span><span class="s1">&#39;__mpl_version__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">__version__</span>

        <span class="c1"># check whether the figure manager (if any) is registered with pyplot</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_pylab_helpers</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">manager</span> <span class="ow">in</span> <span class="n">_pylab_helpers</span><span class="o">.</span><span class="n">Gcf</span><span class="o">.</span><span class="n">figs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_restore_to_pylab&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">version</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;__mpl_version__&#39;</span><span class="p">)</span>
        <span class="n">restore_to_pylab</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;_restore_to_pylab&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">version</span> <span class="o">!=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">__version__</span><span class="p">:</span>
            <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;This figure was saved with matplotlib version </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2"> and &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;loaded with </span><span class="si">{</span><span class="n">mpl</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2"> so may not function correctly.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">state</span>

        <span class="c1"># re-initialise some of the unstored state information</span>
        <span class="n">FigureCanvasBase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># Set self.canvas.</span>

        <span class="k">if</span> <span class="n">restore_to_pylab</span><span class="p">:</span>
            <span class="c1"># lazy import to avoid circularity</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib._pylab_helpers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pylab_helpers</span>
            <span class="n">allnums</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_fignums</span><span class="p">()</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">allnums</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">allnums</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">backend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">_get_backend_mod</span><span class="p">()</span>
            <span class="n">mgr</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">new_figure_manager_given_figure</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="n">pylab_helpers</span><span class="o">.</span><span class="n">Gcf</span><span class="o">.</span><span class="n">_set_new_active_manager</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">draw_if_interactive</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Figure.add_axobserver">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.add_axobserver">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_axobserver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whenever the Axes state change, ``func(self)`` will be called.&quot;&quot;&quot;</span>
        <span class="c1"># Connect a wrapper lambda and not func itself, to avoid it being</span>
        <span class="c1"># weakref-collected.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axobservers</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;_axes_change_event&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">arg</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">arg</span><span class="p">))</span></div>


<div class="viewcode-block" id="Figure.savefig">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.savefig">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">savefig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fname</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the current figure as an image or vector graphic to a file.</span>

<span class="sd">        Call signature::</span>

<span class="sd">          savefig(fname, *, transparent=None, dpi=&#39;figure&#39;, format=None,</span>
<span class="sd">                  metadata=None, bbox_inches=None, pad_inches=0.1,</span>
<span class="sd">                  facecolor=&#39;auto&#39;, edgecolor=&#39;auto&#39;, backend=None,</span>
<span class="sd">                  **kwargs</span>
<span class="sd">                 )</span>

<span class="sd">        The available output formats depend on the backend being used.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fname : str or path-like or binary file-like</span>
<span class="sd">            A path, or a Python file-like object, or</span>
<span class="sd">            possibly some backend-dependent object such as</span>
<span class="sd">            `matplotlib.backends.backend_pdf.PdfPages`.</span>

<span class="sd">            If *format* is set, it determines the output format, and the file</span>
<span class="sd">            is saved as *fname*.  Note that *fname* is used verbatim, and there</span>
<span class="sd">            is no attempt to make the extension, if any, of *fname* match</span>
<span class="sd">            *format*, and no extension is appended.</span>

<span class="sd">            If *format* is not set, then the format is inferred from the</span>
<span class="sd">            extension of *fname*, if there is one.  If *format* is not</span>
<span class="sd">            set and *fname* has no extension, then the file is saved with</span>
<span class="sd">            :rc:`savefig.format` and the appropriate extension is appended to</span>
<span class="sd">            *fname*.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        transparent : bool, default: :rc:`savefig.transparent`</span>
<span class="sd">            If *True*, the Axes patches will all be transparent; the</span>
<span class="sd">            Figure patch will also be transparent unless *facecolor*</span>
<span class="sd">            and/or *edgecolor* are specified via kwargs.</span>

<span class="sd">            If *False* has no effect and the color of the Axes and</span>
<span class="sd">            Figure patches are unchanged (unless the Figure patch</span>
<span class="sd">            is specified via the *facecolor* and/or *edgecolor* keyword</span>
<span class="sd">            arguments in which case those colors are used).</span>

<span class="sd">            The transparency of these patches will be restored to their</span>
<span class="sd">            original values upon exit of this function.</span>

<span class="sd">            This is useful, for example, for displaying</span>
<span class="sd">            a plot on top of a colored background on a web page.</span>

<span class="sd">        dpi : float or &#39;figure&#39;, default: :rc:`savefig.dpi`</span>
<span class="sd">            The resolution in dots per inch.  If &#39;figure&#39;, use the figure&#39;s</span>
<span class="sd">            dpi value.</span>

<span class="sd">        format : str</span>
<span class="sd">            The file format, e.g. &#39;png&#39;, &#39;pdf&#39;, &#39;svg&#39;, ... The behavior when</span>
<span class="sd">            this is unset is documented under *fname*.</span>

<span class="sd">        metadata : dict, optional</span>
<span class="sd">            Key/value pairs to store in the image metadata. The supported keys</span>
<span class="sd">            and defaults depend on the image format and backend:</span>

<span class="sd">            - &#39;png&#39; with Agg backend: See the parameter ``metadata`` of</span>
<span class="sd">              `~.FigureCanvasAgg.print_png`.</span>
<span class="sd">            - &#39;pdf&#39; with pdf backend: See the parameter ``metadata`` of</span>
<span class="sd">              `~.backend_pdf.PdfPages`.</span>
<span class="sd">            - &#39;svg&#39; with svg backend: See the parameter ``metadata`` of</span>
<span class="sd">              `~.FigureCanvasSVG.print_svg`.</span>
<span class="sd">            - &#39;eps&#39; and &#39;ps&#39; with PS backend: Only &#39;Creator&#39; is supported.</span>

<span class="sd">            Not supported for &#39;pgf&#39;, &#39;raw&#39;, and &#39;rgba&#39; as those formats do not support</span>
<span class="sd">            embedding metadata.</span>
<span class="sd">            Does not currently support &#39;jpg&#39;, &#39;tiff&#39;, or &#39;webp&#39;, but may include</span>
<span class="sd">            embedding EXIF metadata in the future.</span>

<span class="sd">        bbox_inches : str or `.Bbox`, default: :rc:`savefig.bbox`</span>
<span class="sd">            Bounding box in inches: only the given portion of the figure is</span>
<span class="sd">            saved.  If &#39;tight&#39;, try to figure out the tight bbox of the figure.</span>

<span class="sd">        pad_inches : float or &#39;layout&#39;, default: :rc:`savefig.pad_inches`</span>
<span class="sd">            Amount of padding in inches around the figure when bbox_inches is</span>
<span class="sd">            &#39;tight&#39;. If &#39;layout&#39; use the padding from the constrained or</span>
<span class="sd">            compressed layout engine; ignored if one of those engines is not in</span>
<span class="sd">            use.</span>

<span class="sd">        facecolor : :mpltype:`color` or &#39;auto&#39;, default: :rc:`savefig.facecolor`</span>
<span class="sd">            The facecolor of the figure.  If &#39;auto&#39;, use the current figure</span>
<span class="sd">            facecolor.</span>

<span class="sd">        edgecolor : :mpltype:`color` or &#39;auto&#39;, default: :rc:`savefig.edgecolor`</span>
<span class="sd">            The edgecolor of the figure.  If &#39;auto&#39;, use the current figure</span>
<span class="sd">            edgecolor.</span>

<span class="sd">        backend : str, optional</span>
<span class="sd">            Use a non-default backend to render the file, e.g. to render a</span>
<span class="sd">            png file with the &quot;cairo&quot; backend rather than the default &quot;agg&quot;,</span>
<span class="sd">            or a pdf file with the &quot;pgf&quot; backend rather than the default</span>
<span class="sd">            &quot;pdf&quot;.  Note that the default backend is normally sufficient.  See</span>
<span class="sd">            :ref:`the-builtin-backends` for a list of valid backends for each</span>
<span class="sd">            file format.  Custom backends can be referenced as &quot;module://...&quot;.</span>

<span class="sd">        orientation : {&#39;landscape&#39;, &#39;portrait&#39;}</span>
<span class="sd">            Currently only supported by the postscript backend.</span>

<span class="sd">        papertype : str</span>
<span class="sd">            One of &#39;letter&#39;, &#39;legal&#39;, &#39;executive&#39;, &#39;ledger&#39;, &#39;a0&#39; through</span>
<span class="sd">            &#39;a10&#39;, &#39;b0&#39; through &#39;b10&#39;. Only supported for postscript</span>
<span class="sd">            output.</span>

<span class="sd">        bbox_extra_artists : list of `~matplotlib.artist.Artist`, optional</span>
<span class="sd">            A list of extra artists that will be considered when the</span>
<span class="sd">            tight bbox is calculated.</span>

<span class="sd">        pil_kwargs : dict, optional</span>
<span class="sd">            Additional keyword arguments that are passed to</span>
<span class="sd">            `PIL.Image.Image.save` when saving the figure.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;dpi&#39;</span><span class="p">,</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">transparent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">transparent</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.transparent&#39;</span><span class="p">]</span>

        <span class="k">with</span> <span class="n">ExitStack</span><span class="p">()</span> <span class="k">as</span> <span class="n">stack</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">transparent</span><span class="p">:</span>
                <span class="k">def</span><span class="w"> </span><span class="nf">_recursively_make_subfig_transparent</span><span class="p">(</span><span class="n">exit_stack</span><span class="p">,</span> <span class="n">subfig</span><span class="p">):</span>
                    <span class="n">exit_stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span>
                        <span class="n">subfig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">_cm_set</span><span class="p">(</span>
                            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">subfig</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                        <span class="n">exit_stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span>
                            <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">_cm_set</span><span class="p">(</span>
                                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">sub_subfig</span> <span class="ow">in</span> <span class="n">subfig</span><span class="o">.</span><span class="n">subfigs</span><span class="p">:</span>
                        <span class="n">_recursively_make_subfig_transparent</span><span class="p">(</span>
                            <span class="n">exit_stack</span><span class="p">,</span> <span class="n">sub_subfig</span><span class="p">)</span>

                <span class="k">def</span><span class="w"> </span><span class="nf">_recursively_make_axes_transparent</span><span class="p">(</span><span class="n">exit_stack</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
                    <span class="n">exit_stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">_cm_set</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">child_ax</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">child_axes</span><span class="p">:</span>
                        <span class="n">exit_stack</span><span class="o">.</span><span class="n">enter_context</span><span class="p">(</span>
                            <span class="n">child_ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">_cm_set</span><span class="p">(</span>
                                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">child_childax</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">child_axes</span><span class="p">:</span>
                        <span class="n">_recursively_make_axes_transparent</span><span class="p">(</span>
                            <span class="n">exit_stack</span><span class="p">,</span> <span class="n">child_childax</span><span class="p">)</span>

                <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;facecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">)</span>
                <span class="c1"># set subfigure to appear transparent in printed image</span>
                <span class="k">for</span> <span class="n">subfig</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subfigs</span><span class="p">:</span>
                    <span class="n">_recursively_make_subfig_transparent</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="n">subfig</span><span class="p">)</span>
                <span class="c1"># set Axes to be transparent</span>
                <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
                    <span class="n">_recursively_make_axes_transparent</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Figure.ginput">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.ginput">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">ginput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">show_clicks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">mouse_add</span><span class="o">=</span><span class="n">MouseButton</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span>
               <span class="n">mouse_pop</span><span class="o">=</span><span class="n">MouseButton</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span>
               <span class="n">mouse_stop</span><span class="o">=</span><span class="n">MouseButton</span><span class="o">.</span><span class="n">MIDDLE</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Blocking call to interact with a figure.</span>

<span class="sd">        Wait until the user clicks *n* times on the figure, and return the</span>
<span class="sd">        coordinates of each click in a list.</span>

<span class="sd">        There are three possible interactions:</span>

<span class="sd">        - Add a point.</span>
<span class="sd">        - Remove the most recently added point.</span>
<span class="sd">        - Stop the interaction and return the points added so far.</span>

<span class="sd">        The actions are assigned to mouse buttons via the arguments</span>
<span class="sd">        *mouse_add*, *mouse_pop* and *mouse_stop*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n : int, default: 1</span>
<span class="sd">            Number of mouse clicks to accumulate. If negative, accumulate</span>
<span class="sd">            clicks until the input is terminated manually.</span>
<span class="sd">        timeout : float, default: 30 seconds</span>
<span class="sd">            Number of seconds to wait before timing out. If zero or negative</span>
<span class="sd">            will never time out.</span>
<span class="sd">        show_clicks : bool, default: True</span>
<span class="sd">            If True, show a red cross at the location of each click.</span>
<span class="sd">        mouse_add : `.MouseButton` or None, default: `.MouseButton.LEFT`</span>
<span class="sd">            Mouse button used to add points.</span>
<span class="sd">        mouse_pop : `.MouseButton` or None, default: `.MouseButton.RIGHT`</span>
<span class="sd">            Mouse button used to remove the most recently added point.</span>
<span class="sd">        mouse_stop : `.MouseButton` or None, default: `.MouseButton.MIDDLE`</span>
<span class="sd">            Mouse button used to stop input.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list of tuples</span>
<span class="sd">            A list of the clicked (x, y) coordinates.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The keyboard can also be used to select points in case your mouse</span>
<span class="sd">        does not have one or more of the buttons.  The delete and backspace</span>
<span class="sd">        keys act like right-clicking (i.e., remove last point), the enter key</span>
<span class="sd">        terminates input and any other key (not already used by the window</span>
<span class="sd">        manager) selects a point.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clicks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">marks</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">is_button</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;button_press_event&quot;</span>
            <span class="n">is_key</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;key_press_event&quot;</span>
            <span class="c1"># Quit (even if not in infinite mode; this is consistent with</span>
            <span class="c1"># MATLAB and sometimes quite useful, but will require the user to</span>
            <span class="c1"># test how many points were actually returned before using data).</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">is_button</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="n">mouse_stop</span>
                    <span class="ow">or</span> <span class="n">is_key</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;escape&quot;</span><span class="p">,</span> <span class="s2">&quot;enter&quot;</span><span class="p">]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">stop_event_loop</span><span class="p">()</span>
            <span class="c1"># Pop last click.</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">is_button</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="n">mouse_pop</span>
                  <span class="ow">or</span> <span class="n">is_key</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;backspace&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">clicks</span><span class="p">:</span>
                    <span class="n">clicks</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">show_clicks</span><span class="p">:</span>
                        <span class="n">marks</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="c1"># Add new click.</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">is_button</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">button</span> <span class="o">==</span> <span class="n">mouse_add</span>
                  <span class="c1"># On macOS/gtk, some keys return None.</span>
                  <span class="ow">or</span> <span class="n">is_key</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span><span class="p">:</span>
                    <span class="n">clicks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">))</span>
                    <span class="n">_log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;input </span><span class="si">%i</span><span class="s2">: </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">&quot;</span><span class="p">,</span>
                              <span class="nb">len</span><span class="p">(</span><span class="n">clicks</span><span class="p">),</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">show_clicks</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="n">event</span><span class="o">.</span><span class="n">xdata</span><span class="p">],</span> <span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">ydata</span><span class="p">],</span>
                                                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
                        <span class="n">event</span><span class="o">.</span><span class="n">inaxes</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="n">marks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">clicks</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">stop_event_loop</span><span class="p">()</span>

        <span class="n">_blocking_input</span><span class="o">.</span><span class="n">blocking_input_loop</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="s2">&quot;key_press_event&quot;</span><span class="p">],</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>

        <span class="c1"># Cleanup.</span>
        <span class="k">for</span> <span class="n">mark</span> <span class="ow">in</span> <span class="n">marks</span><span class="p">:</span>
            <span class="n">mark</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">clicks</span></div>


<div class="viewcode-block" id="Figure.waitforbuttonpress">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.waitforbuttonpress">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">waitforbuttonpress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Blocking call to interact with the figure.</span>

<span class="sd">        Wait for user input and return True if a key was pressed, False if a</span>
<span class="sd">        mouse button was pressed and None if no input was given within</span>
<span class="sd">        *timeout* seconds.  Negative values deactivate *timeout*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">event</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">handler</span><span class="p">(</span><span class="n">ev</span><span class="p">):</span>
            <span class="k">nonlocal</span> <span class="n">event</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">ev</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">stop_event_loop</span><span class="p">()</span>

        <span class="n">_blocking_input</span><span class="o">.</span><span class="n">blocking_input_loop</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;button_press_event&quot;</span><span class="p">,</span> <span class="s2">&quot;key_press_event&quot;</span><span class="p">],</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">event</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">event</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;key_press_event&quot;</span></div>


<div class="viewcode-block" id="Figure.tight_layout">
<a class="viewcode-back" href="../../_autosummary/bmctool.utils.eval.Figure.html#bmctool.utils.eval.Figure.tight_layout">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tight_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">1.08</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adjust the padding between and around subplots.</span>

<span class="sd">        To exclude an artist on the Axes from the bounding box calculation</span>
<span class="sd">        that determines the subplot parameters (i.e. legend, or annotation),</span>
<span class="sd">        set ``a.set_in_layout(False)`` for that artist.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pad : float, default: 1.08</span>
<span class="sd">            Padding between the figure edge and the edges of subplots,</span>
<span class="sd">            as a fraction of the font size.</span>
<span class="sd">        h_pad, w_pad : float, default: *pad*</span>
<span class="sd">            Padding (height/width) between edges of adjacent subplots,</span>
<span class="sd">            as a fraction of the font size.</span>
<span class="sd">        rect : tuple (left, bottom, right, top), default: (0, 0, 1, 1)</span>
<span class="sd">            A rectangle in normalized figure coordinates into which the whole</span>
<span class="sd">            subplots area (including labels) will fit.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        .Figure.set_layout_engine</span>
<span class="sd">        .pyplot.tight_layout</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># note that here we do not permanently set the figures engine to</span>
        <span class="c1"># tight_layout but rather just perform the layout in place and remove</span>
        <span class="c1"># any previous engines.</span>
        <span class="n">engine</span> <span class="o">=</span> <span class="n">TightLayoutEngine</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="n">pad</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="n">h_pad</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="n">w_pad</span><span class="p">,</span> <span class="n">rect</span><span class="o">=</span><span class="n">rect</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">previous_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_layout_engine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="n">engine</span><span class="p">)</span>
            <span class="n">engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">previous_engine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">previous_engine</span><span class="p">,</span> <span class="p">(</span><span class="n">TightLayoutEngine</span><span class="p">,</span> <span class="n">PlaceHolderLayoutEngine</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span><span class="s1">&#39;The figure layout has changed to tight&#39;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_layout_engine</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span></div>
</div>



<span class="k">def</span><span class="w"> </span><span class="nf">figaspect</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the width and height for a figure with a specified aspect ratio.</span>

<span class="sd">    While the height is taken from :rc:`figure.figsize`, the width is</span>
<span class="sd">    adjusted to match the desired aspect ratio. Additionally, it is ensured</span>
<span class="sd">    that the width is in the range [4., 16.] and the height is in the range</span>
<span class="sd">    [2., 16.]. If necessary, the default height is adjusted to ensure this.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    arg : float or 2D array</span>
<span class="sd">        If a float, this defines the aspect ratio (i.e. the ratio height /</span>
<span class="sd">        width).</span>
<span class="sd">        In case of an array the aspect ratio is number of rows / number of</span>
<span class="sd">        columns, so that the array could be fitted in the figure undistorted.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    width, height : float</span>
<span class="sd">        The figure size in inches.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    If you want to create an Axes within the figure, that still preserves the</span>
<span class="sd">    aspect ratio, be sure to create it with equal width and height. See</span>
<span class="sd">    examples below.</span>

<span class="sd">    Thanks to Fernando Perez for this function.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Make a figure twice as tall as it is wide::</span>

<span class="sd">        w, h = figaspect(2.)</span>
<span class="sd">        fig = Figure(figsize=(w, h))</span>
<span class="sd">        ax = fig.add_axes([0.1, 0.1, 0.8, 0.8])</span>
<span class="sd">        ax.imshow(A, **kwargs)</span>

<span class="sd">    Make a figure with the proper aspect for an array::</span>

<span class="sd">        A = rand(5, 3)</span>
<span class="sd">        w, h = figaspect(A)</span>
<span class="sd">        fig = Figure(figsize=(w, h))</span>
<span class="sd">        ax = fig.add_axes([0.1, 0.1, 0.8, 0.8])</span>
<span class="sd">        ax.imshow(A, **kwargs)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">isarray</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="c1"># min/max sizes to respect when autoscaling.  If John likes the idea, they</span>
    <span class="c1"># could become rc parameters, for now they&#39;re hardwired.</span>
    <span class="n">figsize_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>  <span class="c1"># min length for width/height</span>
    <span class="n">figsize_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mf">16.0</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">))</span>  <span class="c1"># max length for width/height</span>

    <span class="c1"># Extract the aspect ratio of the array</span>
    <span class="k">if</span> <span class="n">isarray</span><span class="p">:</span>
        <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">arr_ratio</span> <span class="o">=</span> <span class="n">nr</span> <span class="o">/</span> <span class="n">nc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">arr_ratio</span> <span class="o">=</span> <span class="n">arg</span>

    <span class="c1"># Height of user figure defaults</span>
    <span class="n">fig_height</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># New size for the figure, keeping the aspect ratio of the caller</span>
    <span class="n">newsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">fig_height</span> <span class="o">/</span> <span class="n">arr_ratio</span><span class="p">,</span> <span class="n">fig_height</span><span class="p">))</span>

    <span class="c1"># Sanity checks, don&#39;t drop either dimension below figsize_min</span>
    <span class="n">newsize</span> <span class="o">/=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">newsize</span> <span class="o">/</span> <span class="n">figsize_min</span><span class="p">))</span>

    <span class="c1"># Avoid humongous windows as well</span>
    <span class="n">newsize</span> <span class="o">/=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">newsize</span> <span class="o">/</span> <span class="n">figsize_max</span><span class="p">))</span>

    <span class="c1"># Finally, if we have a really funky aspect ratio, break it but respect</span>
    <span class="c1"># the min/max dimensions (we don&#39;t want figures 10 feet tall!)</span>
    <span class="n">newsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">newsize</span><span class="p">,</span> <span class="n">figsize_min</span><span class="p">,</span> <span class="n">figsize_max</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newsize</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Patrick Schuenke.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>